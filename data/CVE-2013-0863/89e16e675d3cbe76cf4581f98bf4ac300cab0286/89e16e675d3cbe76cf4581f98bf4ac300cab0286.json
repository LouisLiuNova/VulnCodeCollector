{
    "owner": "FFmpeg",
    "repo": "FFmpeg",
    "commit_sha": "89e16e675d3cbe76cf4581f98bf4ac300cab0286",
    "commit_massage": "sanm: Check decoded_size.\n\nThis prevents a buffer overflow in rle_decode()\n\nFound-by: Mateusz \"j00ru\" Jurczyk and Gynvael Coldwind\nSigned-off-by: Michael Niedermayer <michaelni@gmx.at>\n(cherry picked from commit 7357ca900efcf829de4cce4cec6ddc286526d417)\n\nSigned-off-by: Michael Niedermayer <michaelni@gmx.at>",
    "raw_ref": "https://api.github.com/repos/FFmpeg/FFmpeg/commits/89e16e675d3cbe76cf4581f98bf4ac300cab0286",
    "html_ref": "https://github.com/FFmpeg/FFmpeg/commit/89e16e675d3cbe76cf4581f98bf4ac300cab0286",
    "author": "michaelni",
    "changes_stats": {
        "total": 5,
        "additions": 5,
        "deletions": 0
    },
    "files": [
        {
            "sha": "21073e2344b32f8f8a13e84c7bb219f8e26d07c8",
            "filename": "libavcodec/sanm.c",
            "status": "modified",
            "additions": 5,
            "deletions": 0,
            "changes": 5,
            "blob_url": "https://github.com/FFmpeg/FFmpeg/blob/89e16e675d3cbe76cf4581f98bf4ac300cab0286/libavcodec%2Fsanm.c",
            "raw_url": "https://github.com/FFmpeg/FFmpeg/raw/89e16e675d3cbe76cf4581f98bf4ac300cab0286/libavcodec%2Fsanm.c",
            "contents_url": "https://api.github.com/repos/FFmpeg/FFmpeg/contents/libavcodec%2Fsanm.c?ref=89e16e675d3cbe76cf4581f98bf4ac300cab0286",
            "patch": "@@ -638,6 +638,11 @@ static int old_codec47(SANMVideoContext *ctx, int top,\n     decoded_size = bytestream2_get_le32(&ctx->gb);\n     bytestream2_skip(&ctx->gb, 8);\n \n+    if (decoded_size > height * stride - left - top * stride) {\n+        decoded_size = height * stride - left - top * stride;\n+        av_log(ctx->avctx, AV_LOG_WARNING, \"decoded size is too large\\n\");\n+    }\n+\n     if (skip & 1)\n         bytestream2_skip(&ctx->gb, 0x8080);\n     if (!seq) {"
        }
    ],
    "parent_commit_sha": "4cd1dad91ae97fe1f0dd534c3f5566787566f137"
}