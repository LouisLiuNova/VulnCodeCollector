{
    "owner": "torvalds",
    "repo": "linux",
    "commit_sha": "715230a44310a8cf66fbfb5a46f9a62a9b2de424",
    "commit_massage": "tg3: fix length overflow in VPD firmware parsing\n\nCommit 184b89044fb6e2a74611dafa69b1dce0d98612c6 (\"tg3: Use VPD fw version\nwhen present\") introduced VPD parsing that contained a potential length\noverflow.\n\nLimit the hardware's reported firmware string length (max 255 bytes) to\nstay inside the driver's firmware string length (32 bytes). On overflow,\ntruncate the formatted firmware string instead of potentially overwriting\nportions of the tg3 struct.\n\nhttp://cansecwest.com/slides/2013/PrivateCore%20CSW%202013.pdf\n\nSigned-off-by: Kees Cook <keescook@chromium.org>\nReported-by: Oded Horovitz <oded@privatecore.com>\nReported-by: Brad Spengler <spender@grsecurity.net>\nCc: stable@vger.kernel.org\nCc: Matt Carlson <mcarlson@broadcom.com>\nSigned-off-by: David S. Miller <davem@davemloft.net>",
    "raw_ref": "https://api.github.com/repos/torvalds/linux/commits/715230a44310a8cf66fbfb5a46f9a62a9b2de424",
    "html_ref": "https://github.com/torvalds/linux/commit/715230a44310a8cf66fbfb5a46f9a62a9b2de424",
    "author": "kees",
    "changes_stats": {
        "total": 7,
        "additions": 5,
        "deletions": 2
    },
    "files": [
        {
            "sha": "17a972734ba746d9218df4bf025218a91ebee947",
            "filename": "drivers/net/ethernet/broadcom/tg3.c",
            "status": "modified",
            "additions": 5,
            "deletions": 2,
            "changes": 7,
            "blob_url": "https://github.com/torvalds/linux/blob/715230a44310a8cf66fbfb5a46f9a62a9b2de424/drivers%2Fnet%2Fethernet%2Fbroadcom%2Ftg3.c",
            "raw_url": "https://github.com/torvalds/linux/raw/715230a44310a8cf66fbfb5a46f9a62a9b2de424/drivers%2Fnet%2Fethernet%2Fbroadcom%2Ftg3.c",
            "contents_url": "https://api.github.com/repos/torvalds/linux/contents/drivers%2Fnet%2Fethernet%2Fbroadcom%2Ftg3.c?ref=715230a44310a8cf66fbfb5a46f9a62a9b2de424",
            "patch": "@@ -14604,8 +14604,11 @@ static void tg3_read_vpd(struct tg3 *tp)\n \t\tif (j + len > block_end)\n \t\t\tgoto partno;\n \n-\t\tmemcpy(tp->fw_ver, &vpd_data[j], len);\n-\t\tstrncat(tp->fw_ver, \" bc \", vpdlen - len - 1);\n+\t\tif (len >= sizeof(tp->fw_ver))\n+\t\t\tlen = sizeof(tp->fw_ver) - 1;\n+\t\tmemset(tp->fw_ver, 0, sizeof(tp->fw_ver));\n+\t\tsnprintf(tp->fw_ver, sizeof(tp->fw_ver), \"%.*s bc \", len,\n+\t\t\t &vpd_data[j]);\n \t}\n \n partno:"
        }
    ],
    "parent_commit_sha": "ea872d7712528ad991bdabb63515bc00ee10993e"
}