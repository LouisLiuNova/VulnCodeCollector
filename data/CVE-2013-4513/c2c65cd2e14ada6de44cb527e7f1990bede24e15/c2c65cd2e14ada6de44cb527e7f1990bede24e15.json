{
    "owner": "torvalds",
    "repo": "linux",
    "commit_sha": "c2c65cd2e14ada6de44cb527e7f1990bede24e15",
    "commit_massage": "staging: ozwpan: prevent overflow in oz_cdev_write()\n\nWe need to check \"count\" so we don't overflow the ei->data buffer.\n\nReported-by: Nico Golde <nico@ngolde.de>\nReported-by: Fabian Yamaguchi <fabs@goesec.de>\nSigned-off-by: Dan Carpenter <dan.carpenter@oracle.com>\nCc: stable@kernel.org\nSigned-off-by: Linus Torvalds <torvalds@linux-foundation.org>",
    "raw_ref": "https://api.github.com/repos/torvalds/linux/commits/c2c65cd2e14ada6de44cb527e7f1990bede24e15",
    "html_ref": "https://github.com/torvalds/linux/commit/c2c65cd2e14ada6de44cb527e7f1990bede24e15",
    "author": "Dan Carpenter",
    "changes_stats": {
        "total": 3,
        "additions": 3,
        "deletions": 0
    },
    "files": [
        {
            "sha": "6ce0af9977d8c0ccc053e98eb818a98ec8d990f7",
            "filename": "drivers/staging/ozwpan/ozcdev.c",
            "status": "modified",
            "additions": 3,
            "deletions": 0,
            "changes": 3,
            "blob_url": "https://github.com/torvalds/linux/blob/c2c65cd2e14ada6de44cb527e7f1990bede24e15/drivers%2Fstaging%2Fozwpan%2Fozcdev.c",
            "raw_url": "https://github.com/torvalds/linux/raw/c2c65cd2e14ada6de44cb527e7f1990bede24e15/drivers%2Fstaging%2Fozwpan%2Fozcdev.c",
            "contents_url": "https://api.github.com/repos/torvalds/linux/contents/drivers%2Fstaging%2Fozwpan%2Fozcdev.c?ref=c2c65cd2e14ada6de44cb527e7f1990bede24e15",
            "patch": "@@ -155,6 +155,9 @@ static ssize_t oz_cdev_write(struct file *filp, const char __user *buf,\n \tstruct oz_app_hdr *app_hdr;\n \tstruct oz_serial_ctx *ctx;\n \n+\tif (count > sizeof(ei->data) - sizeof(*elt) - sizeof(*app_hdr))\n+\t\treturn -EINVAL;\n+\n \tspin_lock_bh(&g_cdev.lock);\n \tpd = g_cdev.active_pd;\n \tif (pd)"
        }
    ],
    "parent_commit_sha": "201f99f170df14ba52ea4c52847779042b7a623b"
}