{
    "owner": "torvalds",
    "repo": "linux",
    "commit_sha": "b5e2f339865fb443107e5b10603e53bbc92dc054",
    "commit_massage": "staging: wlags49_h2: buffer overflow setting station name\n\nWe need to check the length parameter before doing the memcpy().  I've\nactually changed it to strlcpy() as well so that it's NUL terminated.\n\nYou need CAP_NET_ADMIN to trigger these so it's not the end of the\nworld.\n\nReported-by: Nico Golde <nico@ngolde.de>\nReported-by: Fabian Yamaguchi <fabs@goesec.de>\nSigned-off-by: Dan Carpenter <dan.carpenter@oracle.com>\nCc: stable@kernel.org\nSigned-off-by: Linus Torvalds <torvalds@linux-foundation.org>",
    "raw_ref": "https://api.github.com/repos/torvalds/linux/commits/b5e2f339865fb443107e5b10603e53bbc92dc054",
    "html_ref": "https://github.com/torvalds/linux/commit/b5e2f339865fb443107e5b10603e53bbc92dc054",
    "author": "Dan Carpenter",
    "changes_stats": {
        "total": 9,
        "additions": 6,
        "deletions": 3
    },
    "files": [
        {
            "sha": "7e10dcdc3090085460918be8dfa9261df14eaa13",
            "filename": "drivers/staging/wlags49_h2/wl_priv.c",
            "status": "modified",
            "additions": 6,
            "deletions": 3,
            "changes": 9,
            "blob_url": "https://github.com/torvalds/linux/blob/b5e2f339865fb443107e5b10603e53bbc92dc054/drivers%2Fstaging%2Fwlags49_h2%2Fwl_priv.c",
            "raw_url": "https://github.com/torvalds/linux/raw/b5e2f339865fb443107e5b10603e53bbc92dc054/drivers%2Fstaging%2Fwlags49_h2%2Fwl_priv.c",
            "contents_url": "https://api.github.com/repos/torvalds/linux/contents/drivers%2Fstaging%2Fwlags49_h2%2Fwl_priv.c?ref=b5e2f339865fb443107e5b10603e53bbc92dc054",
            "patch": "@@ -570,6 +570,7 @@ int wvlan_uil_put_info(struct uilreq *urq, struct wl_private *lp)\n \tltv_t                   *pLtv;\n \tbool_t                  ltvAllocated = FALSE;\n \tENCSTRCT                sEncryption;\n+\tsize_t\t\t\tlen;\n \n #ifdef USE_WDS\n \thcf_16                  hcfPort  = HCF_PORT_0;\n@@ -686,7 +687,8 @@ int wvlan_uil_put_info(struct uilreq *urq, struct wl_private *lp)\n \t\t\t\t\tbreak;\n \t\t\t\tcase CFG_CNF_OWN_NAME:\n \t\t\t\t\tmemset(lp->StationName, 0, sizeof(lp->StationName));\n-\t\t\t\t\tmemcpy((void *)lp->StationName, (void *)&pLtv->u.u8[2], (size_t)pLtv->u.u16[0]);\n+\t\t\t\t\tlen = min_t(size_t, pLtv->u.u16[0], sizeof(lp->StationName));\n+\t\t\t\t\tstrlcpy(lp->StationName, &pLtv->u.u8[2], len);\n \t\t\t\t\tpLtv->u.u16[0] = CNV_INT_TO_LITTLE(pLtv->u.u16[0]);\n \t\t\t\t\tbreak;\n \t\t\t\tcase CFG_CNF_LOAD_BALANCING:\n@@ -1783,6 +1785,7 @@ int wvlan_set_station_nickname(struct net_device *dev,\n {\n \tstruct wl_private *lp = wl_priv(dev);\n \tunsigned long flags;\n+\tsize_t len;\n \tint         ret = 0;\n \t/*------------------------------------------------------------------------*/\n \n@@ -1793,8 +1796,8 @@ int wvlan_set_station_nickname(struct net_device *dev,\n \twl_lock(lp, &flags);\n \n \tmemset(lp->StationName, 0, sizeof(lp->StationName));\n-\n-\tmemcpy(lp->StationName, extra, wrqu->data.length);\n+\tlen = min_t(size_t, wrqu->data.length, sizeof(lp->StationName));\n+\tstrlcpy(lp->StationName, extra, len);\n \n \t/* Commit the adapter parameters */\n \twl_apply(lp);"
        }
    ],
    "parent_commit_sha": "f856567b930dfcdbc3323261bf77240ccdde01f5"
}