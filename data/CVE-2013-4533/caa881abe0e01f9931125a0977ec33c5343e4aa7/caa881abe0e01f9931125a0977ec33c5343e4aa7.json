{
    "owner": "qemu",
    "repo": "qemu",
    "commit_sha": "caa881abe0e01f9931125a0977ec33c5343e4aa7",
    "commit_massage": "pxa2xx: avoid buffer overrun on incoming migration\n\nCVE-2013-4533\n\ns->rx_level is read from the wire and used to determine how many bytes\nto subsequently read into s->rx_fifo[]. If s->rx_level exceeds the\nlength of s->rx_fifo[] the buffer can be overrun with arbitrary data\nfrom the wire.\n\nFix this by validating rx_level against the size of s->rx_fifo.\n\nCc: Don Koch <dkoch@verizon.com>\nReported-by: Michael Roth <mdroth@linux.vnet.ibm.com>\nSigned-off-by: Michael S. Tsirkin <mst@redhat.com>\nReviewed-by: Peter Maydell <peter.maydell@linaro.org>\nReviewed-by: Don Koch <dkoch@verizon.com>\nSigned-off-by: Juan Quintela <quintela@redhat.com>",
    "raw_ref": "https://api.github.com/repos/qemu/qemu/commits/caa881abe0e01f9931125a0977ec33c5343e4aa7",
    "html_ref": "https://github.com/qemu/qemu/commit/caa881abe0e01f9931125a0977ec33c5343e4aa7",
    "author": "mstsirkin",
    "changes_stats": {
        "total": 8,
        "additions": 6,
        "deletions": 2
    },
    "files": [
        {
            "sha": "e0cd847b95063fd86473af0ead5e3da3bc77d193",
            "filename": "hw/arm/pxa2xx.c",
            "status": "modified",
            "additions": 6,
            "deletions": 2,
            "changes": 8,
            "blob_url": "https://github.com/qemu/qemu/blob/caa881abe0e01f9931125a0977ec33c5343e4aa7/hw%2Farm%2Fpxa2xx.c",
            "raw_url": "https://github.com/qemu/qemu/raw/caa881abe0e01f9931125a0977ec33c5343e4aa7/hw%2Farm%2Fpxa2xx.c",
            "contents_url": "https://api.github.com/repos/qemu/qemu/contents/hw%2Farm%2Fpxa2xx.c?ref=caa881abe0e01f9931125a0977ec33c5343e4aa7",
            "patch": "@@ -732,7 +732,7 @@ static void pxa2xx_ssp_save(QEMUFile *f, void *opaque)\n static int pxa2xx_ssp_load(QEMUFile *f, void *opaque, int version_id)\n {\n     PXA2xxSSPState *s = (PXA2xxSSPState *) opaque;\n-    int i;\n+    int i, v;\n \n     s->enable = qemu_get_be32(f);\n \n@@ -746,7 +746,11 @@ static int pxa2xx_ssp_load(QEMUFile *f, void *opaque, int version_id)\n     qemu_get_8s(f, &s->ssrsa);\n     qemu_get_8s(f, &s->ssacd);\n \n-    s->rx_level = qemu_get_byte(f);\n+    v = qemu_get_byte(f);\n+    if (v < 0 || v > ARRAY_SIZE(s->rx_fifo)) {\n+        return -EINVAL;\n+    }\n+    s->rx_level = v;\n     s->rx_start = 0;\n     for (i = 0; i < s->rx_level; i ++)\n         s->rx_fifo[i] = qemu_get_byte(f);"
        }
    ],
    "parent_commit_sha": "36cf2a37132c7f01fa9adb5f95f5312b27742fd4"
}