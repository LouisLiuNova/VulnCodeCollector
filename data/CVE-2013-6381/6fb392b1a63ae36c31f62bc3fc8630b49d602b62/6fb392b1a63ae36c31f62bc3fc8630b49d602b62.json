{
    "owner": "torvalds",
    "repo": "linux",
    "commit_sha": "6fb392b1a63ae36c31f62bc3fc8630b49d602b62",
    "commit_massage": "qeth: avoid buffer overflow in snmp ioctl\n\nCheck user-defined length in snmp ioctl request and allow request\nonly if it fits into a qeth command buffer.\n\nSigned-off-by: Ursula Braun <ursula.braun@de.ibm.com>\nSigned-off-by: Frank Blaschka <frank.blaschka@de.ibm.com>\nReviewed-by: Heiko Carstens <heicars2@linux.vnet.ibm.com>\nReported-by: Nico Golde <nico@ngolde.de>\nReported-by: Fabian Yamaguchi <fabs@goesec.de>\nCc: <stable@vger.kernel.org>\nSigned-off-by: David S. Miller <davem@davemloft.net>",
    "raw_ref": "https://api.github.com/repos/torvalds/linux/commits/6fb392b1a63ae36c31f62bc3fc8630b49d602b62",
    "html_ref": "https://github.com/torvalds/linux/commit/6fb392b1a63ae36c31f62bc3fc8630b49d602b62",
    "author": "braunu",
    "changes_stats": {
        "total": 6,
        "additions": 5,
        "deletions": 1
    },
    "files": [
        {
            "sha": "bd8c09e7a8d9f519928be75819255cfe05bab2b7",
            "filename": "drivers/s390/net/qeth_core_main.c",
            "status": "modified",
            "additions": 5,
            "deletions": 1,
            "changes": 6,
            "blob_url": "https://github.com/torvalds/linux/blob/6fb392b1a63ae36c31f62bc3fc8630b49d602b62/drivers%2Fs390%2Fnet%2Fqeth_core_main.c",
            "raw_url": "https://github.com/torvalds/linux/raw/6fb392b1a63ae36c31f62bc3fc8630b49d602b62/drivers%2Fs390%2Fnet%2Fqeth_core_main.c",
            "contents_url": "https://api.github.com/repos/torvalds/linux/contents/drivers%2Fs390%2Fnet%2Fqeth_core_main.c?ref=6fb392b1a63ae36c31f62bc3fc8630b49d602b62",
            "patch": "@@ -4451,7 +4451,7 @@ int qeth_snmp_command(struct qeth_card *card, char __user *udata)\n \tstruct qeth_cmd_buffer *iob;\n \tstruct qeth_ipa_cmd *cmd;\n \tstruct qeth_snmp_ureq *ureq;\n-\tint req_len;\n+\tunsigned int req_len;\n \tstruct qeth_arp_query_info qinfo = {0, };\n \tint rc = 0;\n \n@@ -4467,6 +4467,10 @@ int qeth_snmp_command(struct qeth_card *card, char __user *udata)\n \t/* skip 4 bytes (data_len struct member) to get req_len */\n \tif (copy_from_user(&req_len, udata + sizeof(int), sizeof(int)))\n \t\treturn -EFAULT;\n+\tif (req_len > (QETH_BUFSIZE - IPA_PDU_HEADER_SIZE -\n+\t\t       sizeof(struct qeth_ipacmd_hdr) -\n+\t\t       sizeof(struct qeth_ipacmd_setadpparms_hdr)))\n+\t\treturn -EINVAL;\n \tureq = memdup_user(udata, req_len + sizeof(struct qeth_snmp_ureq_hdr));\n \tif (IS_ERR(ureq)) {\n \t\tQETH_CARD_TEXT(card, 2, \"snmpnome\");"
        }
    ],
    "parent_commit_sha": "17102f8be41699525cfeeab02adbaf969b156731"
}