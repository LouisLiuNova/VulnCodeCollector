{
    "owner": "torvalds",
    "repo": "linux",
    "commit_sha": "c54def7bd64d7c0b6993336abcffb8444795bf38",
    "commit_massage": "HID: magicmouse: sanity check report size in raw_event() callback\n\nThe report passed to us from transport driver could potentially be\narbitrarily large, therefore we better sanity-check it so that\nmagicmouse_emit_touch() gets only valid values of raw_id.\n\nCc: stable@vger.kernel.org\nReported-by: Steven Vittitoe <scvitti@google.com>\nSigned-off-by: Jiri Kosina <jkosina@suse.cz>",
    "raw_ref": "https://api.github.com/repos/torvalds/linux/commits/c54def7bd64d7c0b6993336abcffb8444795bf38",
    "html_ref": "https://github.com/torvalds/linux/commit/c54def7bd64d7c0b6993336abcffb8444795bf38",
    "author": "Jiri Kosina",
    "changes_stats": {
        "total": 10,
        "additions": 10,
        "deletions": 0
    },
    "files": [
        {
            "sha": "29a74c1efcb85fa727536c4b72be844f9963cd70",
            "filename": "drivers/hid/hid-magicmouse.c",
            "status": "modified",
            "additions": 10,
            "deletions": 0,
            "changes": 10,
            "blob_url": "https://github.com/torvalds/linux/blob/c54def7bd64d7c0b6993336abcffb8444795bf38/drivers%2Fhid%2Fhid-magicmouse.c",
            "raw_url": "https://github.com/torvalds/linux/raw/c54def7bd64d7c0b6993336abcffb8444795bf38/drivers%2Fhid%2Fhid-magicmouse.c",
            "contents_url": "https://api.github.com/repos/torvalds/linux/contents/drivers%2Fhid%2Fhid-magicmouse.c?ref=c54def7bd64d7c0b6993336abcffb8444795bf38",
            "patch": "@@ -290,6 +290,11 @@ static int magicmouse_raw_event(struct hid_device *hdev,\n \t\tif (size < 4 || ((size - 4) % 9) != 0)\n \t\t\treturn 0;\n \t\tnpoints = (size - 4) / 9;\n+\t\tif (npoints > 15) {\n+\t\t\thid_warn(hdev, \"invalid size value (%d) for TRACKPAD_REPORT_ID\\n\",\n+\t\t\t\t\tsize);\n+\t\t\treturn 0;\n+\t\t}\n \t\tmsc->ntouches = 0;\n \t\tfor (ii = 0; ii < npoints; ii++)\n \t\t\tmagicmouse_emit_touch(msc, ii, data + ii * 9 + 4);\n@@ -307,6 +312,11 @@ static int magicmouse_raw_event(struct hid_device *hdev,\n \t\tif (size < 6 || ((size - 6) % 8) != 0)\n \t\t\treturn 0;\n \t\tnpoints = (size - 6) / 8;\n+\t\tif (npoints > 15) {\n+\t\t\thid_warn(hdev, \"invalid size value (%d) for MOUSE_REPORT_ID\\n\",\n+\t\t\t\t\tsize);\n+\t\t\treturn 0;\n+\t\t}\n \t\tmsc->ntouches = 0;\n \t\tfor (ii = 0; ii < npoints; ii++)\n \t\t\tmagicmouse_emit_touch(msc, ii, data + ii * 8 + 6);"
        }
    ],
    "parent_commit_sha": "5abfe85c1d4694d5d4bbd13ecc166262b937adf0"
}