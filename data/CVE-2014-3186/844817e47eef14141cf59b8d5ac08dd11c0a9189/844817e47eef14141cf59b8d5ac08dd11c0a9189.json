{
    "owner": "torvalds",
    "repo": "linux",
    "commit_sha": "844817e47eef14141cf59b8d5ac08dd11c0a9189",
    "commit_massage": "HID: picolcd: sanity check report size in raw_event() callback\n\nThe report passed to us from transport driver could potentially be\narbitrarily large, therefore we better sanity-check it so that raw_data\nthat we hold in picolcd_pending structure are always kept within proper\nbounds.\n\nCc: stable@vger.kernel.org\nReported-by: Steven Vittitoe <scvitti@google.com>\nSigned-off-by: Jiri Kosina <jkosina@suse.cz>",
    "raw_ref": "https://api.github.com/repos/torvalds/linux/commits/844817e47eef14141cf59b8d5ac08dd11c0a9189",
    "html_ref": "https://github.com/torvalds/linux/commit/844817e47eef14141cf59b8d5ac08dd11c0a9189",
    "author": "Jiri Kosina",
    "changes_stats": {
        "total": 6,
        "additions": 6,
        "deletions": 0
    },
    "files": [
        {
            "sha": "020df3c2e8b42717c62bbe0470aa47845535e4a5",
            "filename": "drivers/hid/hid-picolcd_core.c",
            "status": "modified",
            "additions": 6,
            "deletions": 0,
            "changes": 6,
            "blob_url": "https://github.com/torvalds/linux/blob/844817e47eef14141cf59b8d5ac08dd11c0a9189/drivers%2Fhid%2Fhid-picolcd_core.c",
            "raw_url": "https://github.com/torvalds/linux/raw/844817e47eef14141cf59b8d5ac08dd11c0a9189/drivers%2Fhid%2Fhid-picolcd_core.c",
            "contents_url": "https://api.github.com/repos/torvalds/linux/contents/drivers%2Fhid%2Fhid-picolcd_core.c?ref=844817e47eef14141cf59b8d5ac08dd11c0a9189",
            "patch": "@@ -350,6 +350,12 @@ static int picolcd_raw_event(struct hid_device *hdev,\n \tif (!data)\n \t\treturn 1;\n \n+\tif (size > 64) {\n+\t\thid_warn(hdev, \"invalid size value (%d) for picolcd raw event\\n\",\n+\t\t\t\tsize);\n+\t\treturn 0;\n+\t}\n+\n \tif (report->id == REPORT_KEY_STATE) {\n \t\tif (data->input_keys)\n \t\t\tret = picolcd_raw_keypad(data, report, raw_data+1, size-1);"
        }
    ],
    "parent_commit_sha": "c54def7bd64d7c0b6993336abcffb8444795bf38"
}