{
    "owner": "freetype",
    "repo": "freetype",
    "commit_sha": "35252ae9aa1dd9343e9f4884e9ddb1fee10ef415",
    "commit_massage": "Fix Savannah bug #43539.\n\n* src/base/ftobjs.c (Mac_Read_POST_Resource): Fix integer overflow\nby a broken POST table in resource-fork.",
    "raw_ref": "https://api.github.com/repos/freetype/freetype/commits/35252ae9aa1dd9343e9f4884e9ddb1fee10ef415",
    "html_ref": "https://github.com/freetype/freetype/commit/35252ae9aa1dd9343e9f4884e9ddb1fee10ef415",
    "author": "mpsuzuki",
    "changes_stats": {
        "total": 24,
        "additions": 24,
        "deletions": 0
    },
    "files": [
        {
            "sha": "8a246e87f5445c999fbe175d9d196650deb667ef",
            "filename": "ChangeLog",
            "status": "modified",
            "additions": 7,
            "deletions": 0,
            "changes": 7,
            "blob_url": "https://github.com/freetype/freetype/blob/35252ae9aa1dd9343e9f4884e9ddb1fee10ef415/ChangeLog",
            "raw_url": "https://github.com/freetype/freetype/raw/35252ae9aa1dd9343e9f4884e9ddb1fee10ef415/ChangeLog",
            "contents_url": "https://api.github.com/repos/freetype/freetype/contents/ChangeLog?ref=35252ae9aa1dd9343e9f4884e9ddb1fee10ef415",
            "patch": "@@ -1,3 +1,10 @@\n+2014-11-26  suzuki toshiya  <mpsuzuki@hiroshima-u.ac.jp>\n+\n+\tFix Savannah bug #43539.\n+\n+\t* src/base/ftobjs.c (Mac_Read_POST_Resource): Fix integer overflow\n+\tby a broken POST table in resource-fork.\n+\n 2014-11-26  suzuki toshiya  <mpsuzuki@hiroshima-u.ac.jp>\n \n \tFix Savannah bug #43538."
        },
        {
            "sha": "922216e781a6bc28515cf3b162a48ec48a70731e",
            "filename": "src/base/ftobjs.c",
            "status": "modified",
            "additions": 17,
            "deletions": 0,
            "changes": 17,
            "blob_url": "https://github.com/freetype/freetype/blob/35252ae9aa1dd9343e9f4884e9ddb1fee10ef415/src%2Fbase%2Fftobjs.c",
            "raw_url": "https://github.com/freetype/freetype/raw/35252ae9aa1dd9343e9f4884e9ddb1fee10ef415/src%2Fbase%2Fftobjs.c",
            "contents_url": "https://api.github.com/repos/freetype/freetype/contents/src%2Fbase%2Fftobjs.c?ref=35252ae9aa1dd9343e9f4884e9ddb1fee10ef415",
            "patch": "@@ -1617,6 +1617,11 @@\n         goto Exit2;\n       if ( FT_READ_LONG( rlen ) )\n         goto Exit2;\n+      if ( rlen < 0 )\n+      {\n+        error = FT_THROW( Invalid_Offset );\n+        goto Exit2;\n+      }\n       if ( FT_READ_USHORT( flags ) )\n         goto Exit2;\n       FT_TRACE3(( \"POST fragment[%d]: offsets=0x%08x, rlen=0x%08x, flags=0x%04x\\n\",\n@@ -1634,7 +1639,14 @@\n         rlen = 0;\n \n       if ( ( flags >> 8 ) == type )\n+      {\n+        if ( 0x7FFFFFFFL - rlen < len )\n+        {\n+          error = FT_THROW( Array_Too_Large );\n+          goto Exit2;\n+        }\n         len += rlen;\n+      }\n       else\n       {\n         if ( pfb_lenpos + 3 > pfb_len + 2 )\n@@ -1663,6 +1675,11 @@\n       }\n \n       error = FT_ERR( Cannot_Open_Resource );\n+      if ( rlen > 0x7FFFFFFFL - pfb_pos )\n+      {\n+        error = FT_THROW( Array_Too_Large );\n+        goto Exit2;\n+      }\n       if ( pfb_pos > pfb_len || pfb_pos + rlen > pfb_len )\n         goto Exit2;\n "
        }
    ],
    "parent_commit_sha": "240c94a185cd8dae7d03059abec8a5662c35ecd3"
}