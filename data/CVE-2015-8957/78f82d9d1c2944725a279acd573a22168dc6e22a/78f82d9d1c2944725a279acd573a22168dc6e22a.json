{
    "owner": "ImageMagick",
    "repo": "ImageMagick",
    "commit_sha": "78f82d9d1c2944725a279acd573a22168dc6e22a",
    "commit_massage": "http://www.imagemagick.org/discourse-server/viewtopic.php?f=3&t=26838",
    "raw_ref": "https://api.github.com/repos/ImageMagick/ImageMagick/commits/78f82d9d1c2944725a279acd573a22168dc6e22a",
    "html_ref": "https://github.com/ImageMagick/ImageMagick/commit/78f82d9d1c2944725a279acd573a22168dc6e22a",
    "author": "cristy",
    "changes_stats": {
        "total": 6,
        "additions": 3,
        "deletions": 3
    },
    "files": [
        {
            "sha": "a25eae6281e772ea0a30dea1b79400642c79d7b5",
            "filename": "coders/sun.c",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/ImageMagick/ImageMagick/blob/78f82d9d1c2944725a279acd573a22168dc6e22a/coders%2Fsun.c",
            "raw_url": "https://github.com/ImageMagick/ImageMagick/raw/78f82d9d1c2944725a279acd573a22168dc6e22a/coders%2Fsun.c",
            "contents_url": "https://api.github.com/repos/ImageMagick/ImageMagick/contents/coders%2Fsun.c?ref=78f82d9d1c2944725a279acd573a22168dc6e22a",
            "patch": "@@ -423,8 +423,9 @@ static Image *ReadSUNImage(const ImageInfo *image_info,ExceptionInfo *exception)\n     if ((sun_info.type != RT_ENCODED) && (sun_info.depth >= 8) &&\n         ((number_pixels*((sun_info.depth+7)/8)) > sun_info.length))\n       ThrowReaderException(CorruptImageError,\"ImproperImageHeader\");\n-    sun_data=(unsigned char *) AcquireQuantumMemory((size_t) sun_info.length,\n-      sizeof(*sun_data));\n+    bytes_per_line=sun_info.width*sun_info.depth;\n+    sun_data=(unsigned char *) AcquireQuantumMemory((size_t) MagickMax(\n+      sun_info.length,bytes_per_line*sun_info.width),sizeof(*sun_data));\n     if (sun_data == (unsigned char *) NULL)\n       ThrowReaderException(ResourceLimitError,\"MemoryAllocationFailed\");\n     count=(ssize_t) ReadBlob(image,sun_info.length,sun_data);\n@@ -441,7 +442,6 @@ static Image *ReadSUNImage(const ImageInfo *image_info,ExceptionInfo *exception)\n           Read run-length encoded raster pixels.\n         */\n         height=sun_info.height;\n-        bytes_per_line=sun_info.width*sun_info.depth;\n         if ((height == 0) || (sun_info.width == 0) || (sun_info.depth == 0) ||\n             ((bytes_per_line/sun_info.depth) != sun_info.width))\n           ThrowReaderException(ResourceLimitError,\"MemoryAllocationFailed\");"
        }
    ],
    "parent_commit_sha": "6cad6a521bdee44fcc5ae5511437ad6a3a7365bf"
}