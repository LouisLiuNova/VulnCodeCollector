{
    "owner": "FFmpeg",
    "repo": "FFmpeg",
    "commit_sha": "a5d25faa3f4b18dac737fdb35d0dd68eb0dc2156",
    "commit_massage": "ffserver: Check chunk size\n\nFixes out of array access\n\nFixes: poc_ffserver.py\nFound-by: Paul Cher <paulcher@icloud.com>\nSigned-off-by: Michael Niedermayer <michael@niedermayer.cc>",
    "raw_ref": "https://api.github.com/repos/FFmpeg/FFmpeg/commits/a5d25faa3f4b18dac737fdb35d0dd68eb0dc2156",
    "html_ref": "https://github.com/FFmpeg/FFmpeg/commit/a5d25faa3f4b18dac737fdb35d0dd68eb0dc2156",
    "author": "michaelni",
    "changes_stats": {
        "total": 5,
        "additions": 4,
        "deletions": 1
    },
    "files": [
        {
            "sha": "02a583464b3784b19139c711943372cb2f295cef",
            "filename": "ffserver.c",
            "status": "modified",
            "additions": 4,
            "deletions": 1,
            "changes": 5,
            "blob_url": "https://github.com/FFmpeg/FFmpeg/blob/a5d25faa3f4b18dac737fdb35d0dd68eb0dc2156/ffserver.c",
            "raw_url": "https://github.com/FFmpeg/FFmpeg/raw/a5d25faa3f4b18dac737fdb35d0dd68eb0dc2156/ffserver.c",
            "contents_url": "https://api.github.com/repos/FFmpeg/FFmpeg/contents/ffserver.c?ref=a5d25faa3f4b18dac737fdb35d0dd68eb0dc2156",
            "patch": "@@ -2738,8 +2738,10 @@ static int http_receive_data(HTTPContext *c)\n         } else if (c->buffer_ptr - c->buffer >= 2 &&\n                    !memcmp(c->buffer_ptr - 1, \"\\r\\n\", 2)) {\n             c->chunk_size = strtol(c->buffer, 0, 16);\n-            if (c->chunk_size == 0) // end of stream\n+            if (c->chunk_size <= 0) { // end of stream or invalid chunk size\n+                c->chunk_size = 0;\n                 goto fail;\n+            }\n             c->buffer_ptr = c->buffer;\n             break;\n         } else if (++loop_run > 10)\n@@ -2761,6 +2763,7 @@ static int http_receive_data(HTTPContext *c)\n             /* end of connection : close it */\n             goto fail;\n         else {\n+            av_assert0(len <= c->chunk_size);\n             c->chunk_size -= len;\n             c->buffer_ptr += len;\n             c->data_count += len;"
        }
    ],
    "parent_commit_sha": "a5f27a9c3aa973c543bd8bbf2a78363700bbc03e"
}