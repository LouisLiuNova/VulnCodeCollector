{
    "owner": "freetype",
    "repo": "freetype",
    "commit_sha": "beecf80a6deecbaf5d264d4f864451bde4fe98b8",
    "commit_massage": "[cff] Fix heap buffer overflow (#49858).\n\n* src/cff/cffparse.c (cff_parser_run): Add one more stack size\ncheck.",
    "raw_ref": "https://api.github.com/repos/freetype/freetype/commits/beecf80a6deecbaf5d264d4f864451bde4fe98b8",
    "html_ref": "https://github.com/freetype/freetype/commit/beecf80a6deecbaf5d264d4f864451bde4fe98b8",
    "author": "lemzwerg",
    "changes_stats": {
        "total": 17,
        "additions": 14,
        "deletions": 3
    },
    "files": [
        {
            "sha": "1243bd4bbb1aa274e5811f758f9949d339449d22",
            "filename": "ChangeLog",
            "status": "modified",
            "additions": 7,
            "deletions": 0,
            "changes": 7,
            "blob_url": "https://github.com/freetype/freetype/blob/beecf80a6deecbaf5d264d4f864451bde4fe98b8/ChangeLog",
            "raw_url": "https://github.com/freetype/freetype/raw/beecf80a6deecbaf5d264d4f864451bde4fe98b8/ChangeLog",
            "contents_url": "https://api.github.com/repos/freetype/freetype/contents/ChangeLog?ref=beecf80a6deecbaf5d264d4f864451bde4fe98b8",
            "patch": "@@ -1,3 +1,10 @@\n+2016-12-16  Werner Lemberg  <wl@gnu.org>\n+\n+\t[cff] Fix heap buffer overflow (#49858).\n+\n+\t* src/cff/cffparse.c (cff_parser_run): Add one more stack size\n+\tcheck.\n+\n 2016-12-15  Werner Lemberg  <wl@gnu.org>\n \n \tFix clang warnings."
        },
        {
            "sha": "9b5ad72ca2eb53f8d5375cfdf770f6cd90593e0b",
            "filename": "src/cff/cffparse.c",
            "status": "modified",
            "additions": 7,
            "deletions": 3,
            "changes": 10,
            "blob_url": "https://github.com/freetype/freetype/blob/beecf80a6deecbaf5d264d4f864451bde4fe98b8/src%2Fcff%2Fcffparse.c",
            "raw_url": "https://github.com/freetype/freetype/raw/beecf80a6deecbaf5d264d4f864451bde4fe98b8/src%2Fcff%2Fcffparse.c",
            "contents_url": "https://api.github.com/repos/freetype/freetype/contents/src%2Fcff%2Fcffparse.c?ref=beecf80a6deecbaf5d264d4f864451bde4fe98b8",
            "patch": "@@ -1422,13 +1422,17 @@\n         /* and look for it in our current list.                            */\n \n         FT_UInt                   code;\n-        FT_UInt                   num_args = (FT_UInt)\n-                                             ( parser->top - parser->stack );\n+        FT_UInt                   num_args;\n         const CFF_Field_Handler*  field;\n \n \n+        if ( (FT_UInt)( parser->top - parser->stack ) >= parser->stackSize )\n+          goto Stack_Overflow;\n+\n+        num_args     = (FT_UInt)( parser->top - parser->stack );\n         *parser->top = p;\n-        code = v;\n+        code         = v;\n+\n         if ( v == 12 )\n         {\n           /* two byte operator */"
        }
    ],
    "parent_commit_sha": "01658be6fbda2ff17616158ae5df5dc240a4347c"
}