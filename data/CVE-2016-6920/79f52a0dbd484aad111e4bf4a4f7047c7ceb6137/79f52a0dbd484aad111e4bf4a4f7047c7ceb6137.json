{
    "owner": "FFmpeg",
    "repo": "FFmpeg",
    "commit_sha": "79f52a0dbd484aad111e4bf4a4f7047c7ceb6137",
    "commit_massage": "avcodec/exr: Check tile positions\n\nThis also disabled the case of mixed x/ymin with tiles, the code\nhandles these cases inconsistent for the 2 coordinate axis and is\nunlikely working correctly.\n\nFixes crash\nFixes: poc1.exr, poc2.exr\n\nFound-by: Yaoguang Chen of Aliapy unLimit Security Team\nSigned-off-by: Michael Niedermayer <michael@niedermayer.cc>\n(cherry picked from commit 01aee8148d4fa439cce678a11f5110656c98de1f)\nSigned-off-by: Michael Niedermayer <michael@niedermayer.cc>",
    "raw_ref": "https://api.github.com/repos/FFmpeg/FFmpeg/commits/79f52a0dbd484aad111e4bf4a4f7047c7ceb6137",
    "html_ref": "https://github.com/FFmpeg/FFmpeg/commit/79f52a0dbd484aad111e4bf4a4f7047c7ceb6137",
    "author": "michaelni",
    "changes_stats": {
        "total": 14,
        "additions": 12,
        "deletions": 2
    },
    "files": [
        {
            "sha": "de46028d18fdf3c1f5f41ba6b38da51d8ff4fa78",
            "filename": "libavcodec/exr.c",
            "status": "modified",
            "additions": 12,
            "deletions": 2,
            "changes": 14,
            "blob_url": "https://github.com/FFmpeg/FFmpeg/blob/79f52a0dbd484aad111e4bf4a4f7047c7ceb6137/libavcodec%2Fexr.c",
            "raw_url": "https://github.com/FFmpeg/FFmpeg/raw/79f52a0dbd484aad111e4bf4a4f7047c7ceb6137/libavcodec%2Fexr.c",
            "contents_url": "https://api.github.com/repos/FFmpeg/FFmpeg/contents/libavcodec%2Fexr.c?ref=79f52a0dbd484aad111e4bf4a4f7047c7ceb6137",
            "patch": "@@ -1027,8 +1027,9 @@ static int decode_block(AVCodecContext *avctx, void *tdata,\n     uint64_t line_offset, uncompressed_size;\n     uint16_t *ptr_x;\n     uint8_t *ptr;\n-    uint32_t data_size, line, col = 0;\n-    uint32_t tileX, tileY, tileLevelX, tileLevelY;\n+    uint32_t data_size;\n+    uint64_t line, col = 0;\n+    uint64_t tileX, tileY, tileLevelX, tileLevelY;\n     const uint8_t *src;\n     int axmax = (avctx->width - (s->xmax + 1)) * 2 * s->desc->nb_components; /* nb pixel to add at the right of the datawindow */\n     int bxmin = s->xmin * 2 * s->desc->nb_components; /* nb pixel to add at the left of the datawindow */\n@@ -1059,9 +1060,18 @@ static int decode_block(AVCodecContext *avctx, void *tdata,\n             return AVERROR_PATCHWELCOME;\n         }\n \n+        if (s->xmin || s->ymin) {\n+            avpriv_report_missing_feature(s->avctx, \"Tiles with xmin/ymin\");\n+            return AVERROR_PATCHWELCOME;\n+        }\n+\n         line = s->tile_attr.ySize * tileY;\n         col = s->tile_attr.xSize * tileX;\n \n+        if (line < s->ymin || line > s->ymax ||\n+            col  < s->xmin || col  > s->xmax)\n+            return AVERROR_INVALIDDATA;\n+\n         td->ysize = FFMIN(s->tile_attr.ySize, s->ydelta - tileY * s->tile_attr.ySize);\n         td->xsize = FFMIN(s->tile_attr.xSize, s->xdelta - tileX * s->tile_attr.xSize);\n "
        }
    ],
    "parent_commit_sha": "ae893819620b49f1a04902dca35852139aaa8d36"
}