{
    "owner": "uclouvain",
    "repo": "openjpeg",
    "commit_sha": "4241ae6fbbf1de9658764a80944dc8108f2b4154",
    "commit_massage": "Fix assertion in debug mode / heap-based buffer overflow in opj_write_bytes_LE for Cinema profiles with numresolutions = 1 (#985)",
    "raw_ref": "https://api.github.com/repos/uclouvain/openjpeg/commits/4241ae6fbbf1de9658764a80944dc8108f2b4154",
    "html_ref": "https://github.com/uclouvain/openjpeg/commit/4241ae6fbbf1de9658764a80944dc8108f2b4154",
    "author": "rouault",
    "changes_stats": {
        "total": 14,
        "additions": 10,
        "deletions": 4
    },
    "files": [
        {
            "sha": "54b490a8c5ceb83cd5451bb1f223f66d431a2fa3",
            "filename": "src/lib/openjp2/j2k.c",
            "status": "modified",
            "additions": 10,
            "deletions": 4,
            "changes": 14,
            "blob_url": "https://github.com/uclouvain/openjpeg/blob/4241ae6fbbf1de9658764a80944dc8108f2b4154/src%2Flib%2Fopenjp2%2Fj2k.c",
            "raw_url": "https://github.com/uclouvain/openjpeg/raw/4241ae6fbbf1de9658764a80944dc8108f2b4154/src%2Flib%2Fopenjp2%2Fj2k.c",
            "contents_url": "https://api.github.com/repos/uclouvain/openjpeg/contents/src%2Flib%2Fopenjp2%2Fj2k.c?ref=4241ae6fbbf1de9658764a80944dc8108f2b4154",
            "patch": "@@ -6573,10 +6573,16 @@ static void opj_j2k_set_cinema_parameters(opj_cparameters_t *parameters,\n \n     /* Precincts */\n     parameters->csty |= 0x01;\n-    parameters->res_spec = parameters->numresolution - 1;\n-    for (i = 0; i < parameters->res_spec; i++) {\n-        parameters->prcw_init[i] = 256;\n-        parameters->prch_init[i] = 256;\n+    if (parameters->numresolution == 1) {\n+        parameters->res_spec = 1;\n+        parameters->prcw_init[0] = 128;\n+        parameters->prch_init[0] = 128;\n+    } else {\n+        parameters->res_spec = parameters->numresolution - 1;\n+        for (i = 0; i < parameters->res_spec; i++) {\n+            parameters->prcw_init[i] = 256;\n+            parameters->prch_init[i] = 256;\n+        }\n     }\n \n     /* The progression order shall be CPRL */"
        }
    ],
    "parent_commit_sha": "52d5690a6fcba86b5f117eeac8aca1971cac3688"
}