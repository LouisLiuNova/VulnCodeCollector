{
    "owner": "FFmpeg",
    "repo": "FFmpeg",
    "commit_sha": "e371f031b942d73e02c090170975561fabd5c264",
    "commit_massage": "avcodec/pngdec: Fix off by 1 size in decode_zbuf()\n\nFixes out of array access\nFixes: 444/fuzz-2-ffmpeg_VIDEO_AV_CODEC_ID_PNG_fuzzer\n\nFound-by: continuous fuzzing process https://github.com/google/oss-fuzz/tree/master/targets/ffmpeg\nSigned-off-by: Michael Niedermayer <michael@niedermayer.cc>",
    "raw_ref": "https://api.github.com/repos/FFmpeg/FFmpeg/commits/e371f031b942d73e02c090170975561fabd5c264",
    "html_ref": "https://github.com/FFmpeg/FFmpeg/commit/e371f031b942d73e02c090170975561fabd5c264",
    "author": "michaelni",
    "changes_stats": {
        "total": 6,
        "additions": 3,
        "deletions": 3
    },
    "files": [
        {
            "sha": "50a0a296b3775ffdfd4b4aa541396b71817ed43a",
            "filename": "libavcodec/pngdec.c",
            "status": "modified",
            "additions": 3,
            "deletions": 3,
            "changes": 6,
            "blob_url": "https://github.com/FFmpeg/FFmpeg/blob/e371f031b942d73e02c090170975561fabd5c264/libavcodec%2Fpngdec.c",
            "raw_url": "https://github.com/FFmpeg/FFmpeg/raw/e371f031b942d73e02c090170975561fabd5c264/libavcodec%2Fpngdec.c",
            "contents_url": "https://api.github.com/repos/FFmpeg/FFmpeg/contents/libavcodec%2Fpngdec.c?ref=e371f031b942d73e02c090170975561fabd5c264",
            "patch": "@@ -437,13 +437,13 @@ static int decode_zbuf(AVBPrint *bp, const uint8_t *data,\n     av_bprint_init(bp, 0, -1);\n \n     while (zstream.avail_in > 0) {\n-        av_bprint_get_buffer(bp, 1, &buf, &buf_size);\n-        if (!buf_size) {\n+        av_bprint_get_buffer(bp, 2, &buf, &buf_size);\n+        if (buf_size < 2) {\n             ret = AVERROR(ENOMEM);\n             goto fail;\n         }\n         zstream.next_out  = buf;\n-        zstream.avail_out = buf_size;\n+        zstream.avail_out = buf_size - 1;\n         ret = inflate(&zstream, Z_PARTIAL_FLUSH);\n         if (ret != Z_OK && ret != Z_STREAM_END) {\n             ret = AVERROR_EXTERNAL;"
        }
    ],
    "parent_commit_sha": "a0341b4d74f4db289e15dac0d2988eaa2d18a1bb"
}