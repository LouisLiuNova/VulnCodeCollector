{
    "owner": "torvalds",
    "repo": "linux",
    "commit_sha": "a9e38c3e01ad242fe2a625354cf065c34b01e3aa",
    "commit_massage": "KVM: x86: Catch potential overrun in MCE setup\n\nWe only allocate memory for 32 MCE banks (KVM_MAX_MCE_BANKS) but we\nallow user space to fill up to 255 on setup (mcg_cap & 0xff), corrupting\nkernel memory. Catch these overflows.\n\nSigned-off-by: Jan Kiszka <jan.kiszka@siemens.com>\nSigned-off-by: Marcelo Tosatti <mtosatti@redhat.com>",
    "raw_ref": "https://api.github.com/repos/torvalds/linux/commits/a9e38c3e01ad242fe2a625354cf065c34b01e3aa",
    "html_ref": "https://github.com/torvalds/linux/commit/a9e38c3e01ad242fe2a625354cf065c34b01e3aa",
    "author": "jan-kiszka",
    "changes_stats": {
        "total": 2,
        "additions": 1,
        "deletions": 1
    },
    "files": [
        {
            "sha": "8a93fa894ba65ae66905d6c1209b69c1ecad2500",
            "filename": "arch/x86/kvm/x86.c",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/torvalds/linux/blob/a9e38c3e01ad242fe2a625354cf065c34b01e3aa/arch%2Fx86%2Fkvm%2Fx86.c",
            "raw_url": "https://github.com/torvalds/linux/raw/a9e38c3e01ad242fe2a625354cf065c34b01e3aa/arch%2Fx86%2Fkvm%2Fx86.c",
            "contents_url": "https://api.github.com/repos/torvalds/linux/contents/arch%2Fx86%2Fkvm%2Fx86.c?ref=a9e38c3e01ad242fe2a625354cf065c34b01e3aa",
            "patch": "@@ -1692,7 +1692,7 @@ static int kvm_vcpu_ioctl_x86_setup_mce(struct kvm_vcpu *vcpu,\n \tunsigned bank_num = mcg_cap & 0xff, bank;\n \n \tr = -EINVAL;\n-\tif (!bank_num)\n+\tif (!bank_num || bank_num >= KVM_MAX_MCE_BANKS)\n \t\tgoto out;\n \tif (mcg_cap & ~(KVM_MCE_CAP_SUPPORTED | 0xff | 0xff0000))\n \t\tgoto out;"
        }
    ],
    "parent_commit_sha": "51bb296b09a83ee1aae025778db38f9d2cc7bb1a"
}