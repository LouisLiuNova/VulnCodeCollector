{
    "owner": "torvalds",
    "repo": "linux",
    "commit_sha": "a6331d6f9a4298173b413cf99a40cc86a9d92c37",
    "commit_massage": "memory corruption in X.25 facilities parsing\n\nSigned-of-by: Andrew Hendry <andrew.hendry@gmail.com>\n\nSigned-off-by: David S. Miller <davem@davemloft.net>",
    "raw_ref": "https://api.github.com/repos/torvalds/linux/commits/a6331d6f9a4298173b413cf99a40cc86a9d92c37",
    "html_ref": "https://github.com/torvalds/linux/commit/a6331d6f9a4298173b413cf99a40cc86a9d92c37",
    "author": "AndrewHendry",
    "changes_stats": {
        "total": 10,
        "additions": 6,
        "deletions": 4
    },
    "files": [
        {
            "sha": "3a8c4c419cd4051ce0ce7a586b3d93417f768cb2",
            "filename": "net/x25/x25_facilities.c",
            "status": "modified",
            "additions": 4,
            "deletions": 4,
            "changes": 8,
            "blob_url": "https://github.com/torvalds/linux/blob/a6331d6f9a4298173b413cf99a40cc86a9d92c37/net%2Fx25%2Fx25_facilities.c",
            "raw_url": "https://github.com/torvalds/linux/raw/a6331d6f9a4298173b413cf99a40cc86a9d92c37/net%2Fx25%2Fx25_facilities.c",
            "contents_url": "https://api.github.com/repos/torvalds/linux/contents/net%2Fx25%2Fx25_facilities.c?ref=a6331d6f9a4298173b413cf99a40cc86a9d92c37",
            "patch": "@@ -134,15 +134,15 @@ int x25_parse_facilities(struct sk_buff *skb, struct x25_facilities *facilities,\n \t\tcase X25_FAC_CLASS_D:\n \t\t\tswitch (*p) {\n \t\t\tcase X25_FAC_CALLING_AE:\n-\t\t\t\tif (p[1] > X25_MAX_DTE_FACIL_LEN)\n-\t\t\t\t\tbreak;\n+\t\t\t\tif (p[1] > X25_MAX_DTE_FACIL_LEN || p[1] <= 1)\n+\t\t\t\t\treturn 0;\n \t\t\t\tdte_facs->calling_len = p[2];\n \t\t\t\tmemcpy(dte_facs->calling_ae, &p[3], p[1] - 1);\n \t\t\t\t*vc_fac_mask |= X25_MASK_CALLING_AE;\n \t\t\t\tbreak;\n \t\t\tcase X25_FAC_CALLED_AE:\n-\t\t\t\tif (p[1] > X25_MAX_DTE_FACIL_LEN)\n-\t\t\t\t\tbreak;\n+\t\t\t\tif (p[1] > X25_MAX_DTE_FACIL_LEN || p[1] <= 1)\n+\t\t\t\t\treturn 0;\n \t\t\t\tdte_facs->called_len = p[2];\n \t\t\t\tmemcpy(dte_facs->called_ae, &p[3], p[1] - 1);\n \t\t\t\t*vc_fac_mask |= X25_MASK_CALLED_AE;"
        },
        {
            "sha": "f729f022be69bc8c32b1008e8943c92cf36c1e28",
            "filename": "net/x25/x25_in.c",
            "status": "modified",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/torvalds/linux/blob/a6331d6f9a4298173b413cf99a40cc86a9d92c37/net%2Fx25%2Fx25_in.c",
            "raw_url": "https://github.com/torvalds/linux/raw/a6331d6f9a4298173b413cf99a40cc86a9d92c37/net%2Fx25%2Fx25_in.c",
            "contents_url": "https://api.github.com/repos/torvalds/linux/contents/net%2Fx25%2Fx25_in.c?ref=a6331d6f9a4298173b413cf99a40cc86a9d92c37",
            "patch": "@@ -119,6 +119,8 @@ static int x25_state1_machine(struct sock *sk, struct sk_buff *skb, int frametyp\n \t\t\t\t\t\t&x25->vc_facil_mask);\n \t\t\tif (len > 0)\n \t\t\t\tskb_pull(skb, len);\n+\t\t\telse\n+\t\t\t\treturn -1;\n \t\t\t/*\n \t\t\t *\tCopy any Call User Data.\n \t\t\t */"
        }
    ],
    "parent_commit_sha": "41bb78b4b9adb21cf2c395b6b880aaae99c788b7"
}