{
    "owner": "torvalds",
    "repo": "linux",
    "commit_sha": "0f22072ab50cac7983f9660d33974b45184da4f9",
    "commit_massage": "ARM: 6891/1: prevent heap corruption in OABI semtimedop\n\nWhen CONFIG_OABI_COMPAT is set, the wrapper for semtimedop does not\nbound the nsops argument.  A sufficiently large value will cause an\ninteger overflow in allocation size, followed by copying too much data\ninto the allocated buffer.  Fix this by restricting nsops to SEMOPM.\nUntested.\n\nCc: stable@kernel.org\nSigned-off-by: Dan Rosenberg <drosenberg@vsecurity.com>\nSigned-off-by: Russell King <rmk+kernel@arm.linux.org.uk>",
    "raw_ref": "https://api.github.com/repos/torvalds/linux/commits/0f22072ab50cac7983f9660d33974b45184da4f9",
    "html_ref": "https://github.com/torvalds/linux/commit/0f22072ab50cac7983f9660d33974b45184da4f9",
    "author": "Dan Rosenberg",
    "changes_stats": {
        "total": 2,
        "additions": 1,
        "deletions": 1
    },
    "files": [
        {
            "sha": "af0aaebf4de62e16e70fcfcad8ccafece2879217",
            "filename": "arch/arm/kernel/sys_oabi-compat.c",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/torvalds/linux/blob/0f22072ab50cac7983f9660d33974b45184da4f9/arch%2Farm%2Fkernel%2Fsys_oabi-compat.c",
            "raw_url": "https://github.com/torvalds/linux/raw/0f22072ab50cac7983f9660d33974b45184da4f9/arch%2Farm%2Fkernel%2Fsys_oabi-compat.c",
            "contents_url": "https://api.github.com/repos/torvalds/linux/contents/arch%2Farm%2Fkernel%2Fsys_oabi-compat.c?ref=0f22072ab50cac7983f9660d33974b45184da4f9",
            "patch": "@@ -311,7 +311,7 @@ asmlinkage long sys_oabi_semtimedop(int semid,\n \tlong err;\n \tint i;\n \n-\tif (nsops < 1)\n+\tif (nsops < 1 || nsops > SEMOPM)\n \t\treturn -EINVAL;\n \tsops = kmalloc(sizeof(*sops) * nsops, GFP_KERNEL);\n \tif (!sops)"
        }
    ],
    "parent_commit_sha": "408133e9dca2b94c64b917b144ec816df913a94e"
}