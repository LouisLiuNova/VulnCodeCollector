{
    "owner": "torvalds",
    "repo": "linux",
    "commit_sha": "c2183d1e9b3f313dd8ba2b1b0197c8d9fb86a7ae",
    "commit_massage": "fuse: check size of FUSE_NOTIFY_INVAL_ENTRY message\n\nFUSE_NOTIFY_INVAL_ENTRY didn't check the length of the write so the\nmessage processing could overrun and result in a \"kernel BUG at\nfs/fuse/dev.c:629!\"\n\nReported-by: Han-Wen Nienhuys <hanwenn@gmail.com>\nSigned-off-by: Miklos Szeredi <mszeredi@suse.cz>\nCC: stable@kernel.org",
    "raw_ref": "https://api.github.com/repos/torvalds/linux/commits/c2183d1e9b3f313dd8ba2b1b0197c8d9fb86a7ae",
    "html_ref": "https://github.com/torvalds/linux/commit/c2183d1e9b3f313dd8ba2b1b0197c8d9fb86a7ae",
    "author": "Miklos Szeredi",
    "changes_stats": {
        "total": 4,
        "additions": 4,
        "deletions": 0
    },
    "files": [
        {
            "sha": "168a80f7f12b856e795eb916bf79f5e2348e06f6",
            "filename": "fs/fuse/dev.c",
            "status": "modified",
            "additions": 4,
            "deletions": 0,
            "changes": 4,
            "blob_url": "https://github.com/torvalds/linux/blob/c2183d1e9b3f313dd8ba2b1b0197c8d9fb86a7ae/fs%2Ffuse%2Fdev.c",
            "raw_url": "https://github.com/torvalds/linux/raw/c2183d1e9b3f313dd8ba2b1b0197c8d9fb86a7ae/fs%2Ffuse%2Fdev.c",
            "contents_url": "https://api.github.com/repos/torvalds/linux/contents/fs%2Ffuse%2Fdev.c?ref=c2183d1e9b3f313dd8ba2b1b0197c8d9fb86a7ae",
            "patch": "@@ -1358,6 +1358,10 @@ static int fuse_notify_inval_entry(struct fuse_conn *fc, unsigned int size,\n \tif (outarg.namelen > FUSE_NAME_MAX)\n \t\tgoto err;\n \n+\terr = -EINVAL;\n+\tif (size != sizeof(outarg) + outarg.namelen + 1)\n+\t\tgoto err;\n+\n \tname.name = buf;\n \tname.len = outarg.namelen;\n \terr = fuse_copy_one(cs, buf, outarg.namelen + 1);"
        }
    ],
    "parent_commit_sha": "478e0841b3dce3edc2c67bf0fc51af30f582e9e2"
}