{
    "owner": "torvalds",
    "repo": "linux",
    "commit_sha": "ed8cd3b2cd61004cab85380c52b1817aca1ca49b",
    "commit_massage": "drm/i915: fix integer overflow in i915_gem_execbuffer2()\n\nOn 32-bit systems, a large args->buffer_count from userspace via ioctl\nmay overflow the allocation size, leading to out-of-bounds access.\n\nThis vulnerability was introduced in commit 8408c282 (\"drm/i915:\nFirst try a normal large kmalloc for the temporary exec buffers\").\n\nSigned-off-by: Xi Wang <xi.wang@gmail.com>\nReviewed-by: Chris Wilson <chris@chris-wilson.co.uk>\nCc: stable@vger.kernel.org\nSigned-off-by: Daniel Vetter <daniel.vetter@ffwll.ch>",
    "raw_ref": "https://api.github.com/repos/torvalds/linux/commits/ed8cd3b2cd61004cab85380c52b1817aca1ca49b",
    "html_ref": "https://github.com/torvalds/linux/commit/ed8cd3b2cd61004cab85380c52b1817aca1ca49b",
    "author": "xiw",
    "changes_stats": {
        "total": 3,
        "additions": 2,
        "deletions": 1
    },
    "files": [
        {
            "sha": "7c50e58175c027c6326081243ca3533f477fa612",
            "filename": "drivers/gpu/drm/i915/i915_gem_execbuffer.c",
            "status": "modified",
            "additions": 2,
            "deletions": 1,
            "changes": 3,
            "blob_url": "https://github.com/torvalds/linux/blob/ed8cd3b2cd61004cab85380c52b1817aca1ca49b/drivers%2Fgpu%2Fdrm%2Fi915%2Fi915_gem_execbuffer.c",
            "raw_url": "https://github.com/torvalds/linux/raw/ed8cd3b2cd61004cab85380c52b1817aca1ca49b/drivers%2Fgpu%2Fdrm%2Fi915%2Fi915_gem_execbuffer.c",
            "contents_url": "https://api.github.com/repos/torvalds/linux/contents/drivers%2Fgpu%2Fdrm%2Fi915%2Fi915_gem_execbuffer.c?ref=ed8cd3b2cd61004cab85380c52b1817aca1ca49b",
            "patch": "@@ -1404,7 +1404,8 @@ i915_gem_execbuffer2(struct drm_device *dev, void *data,\n \tstruct drm_i915_gem_exec_object2 *exec2_list = NULL;\n \tint ret;\n \n-\tif (args->buffer_count < 1) {\n+\tif (args->buffer_count < 1 ||\n+\t    args->buffer_count > UINT_MAX / sizeof(*exec2_list)) {\n \t\tDRM_DEBUG(\"execbuf2 with %d buffers\\n\", args->buffer_count);\n \t\treturn -EINVAL;\n \t}"
        }
    ],
    "parent_commit_sha": "e95c8438ea1c56c254f0607c8fb6bca7f463c744"
}