{
    "owner": "torvalds",
    "repo": "linux",
    "commit_sha": "44afb3a04391a74309d16180d1e4f8386fdfa745",
    "commit_massage": "drm/i915: fix integer overflow in i915_gem_do_execbuffer()\n\nOn 32-bit systems, a large args->num_cliprects from userspace via ioctl\nmay overflow the allocation size, leading to out-of-bounds access.\n\nThis vulnerability was introduced in commit 432e58ed (\"drm/i915: Avoid\nallocation for execbuffer object list\").\n\nSigned-off-by: Xi Wang <xi.wang@gmail.com>\nReviewed-by: Chris Wilson <chris@chris-wilson.co.uk>\nCc: stable@vger.kernel.org\nSigned-off-by: Daniel Vetter <daniel.vetter@ffwll.ch>",
    "raw_ref": "https://api.github.com/repos/torvalds/linux/commits/44afb3a04391a74309d16180d1e4f8386fdfa745",
    "html_ref": "https://github.com/torvalds/linux/commit/44afb3a04391a74309d16180d1e4f8386fdfa745",
    "author": "xiw",
    "changes_stats": {
        "total": 5,
        "additions": 5,
        "deletions": 0
    },
    "files": [
        {
            "sha": "de431942ded4bb5a7b6f5a380e6009cd6b22b696",
            "filename": "drivers/gpu/drm/i915/i915_gem_execbuffer.c",
            "status": "modified",
            "additions": 5,
            "deletions": 0,
            "changes": 5,
            "blob_url": "https://github.com/torvalds/linux/blob/44afb3a04391a74309d16180d1e4f8386fdfa745/drivers%2Fgpu%2Fdrm%2Fi915%2Fi915_gem_execbuffer.c",
            "raw_url": "https://github.com/torvalds/linux/raw/44afb3a04391a74309d16180d1e4f8386fdfa745/drivers%2Fgpu%2Fdrm%2Fi915%2Fi915_gem_execbuffer.c",
            "contents_url": "https://api.github.com/repos/torvalds/linux/contents/drivers%2Fgpu%2Fdrm%2Fi915%2Fi915_gem_execbuffer.c?ref=44afb3a04391a74309d16180d1e4f8386fdfa745",
            "patch": "@@ -1133,6 +1133,11 @@ i915_gem_do_execbuffer(struct drm_device *dev, void *data,\n \t\t\treturn -EINVAL;\n \t\t}\n \n+\t\tif (args->num_cliprects > UINT_MAX / sizeof(*cliprects)) {\n+\t\t\tDRM_DEBUG(\"execbuf with %u cliprects\\n\",\n+\t\t\t\t  args->num_cliprects);\n+\t\t\treturn -EINVAL;\n+\t\t}\n \t\tcliprects = kmalloc(args->num_cliprects * sizeof(*cliprects),\n \t\t\t\t    GFP_KERNEL);\n \t\tif (cliprects == NULL) {"
        }
    ],
    "parent_commit_sha": "ed8cd3b2cd61004cab85380c52b1817aca1ca49b"
}