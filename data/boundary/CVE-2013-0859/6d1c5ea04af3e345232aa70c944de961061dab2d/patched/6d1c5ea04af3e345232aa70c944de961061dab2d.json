{
    "owner": "FFmpeg",
    "repo": "FFmpeg",
    "commit_sha": "6d1c5ea04af3e345232aa70c944de961061dab2d",
    "commit_massage": "tiffdec: check count in metadata reading.\n\nFixes out of array access\n\nFound-by: Mateusz \"j00ru\" Jurczyk and Gynvael Coldwind\nSigned-off-by: Michael Niedermayer <michaelni@gmx.at>",
    "raw_ref": "https://api.github.com/repos/FFmpeg/FFmpeg/commits/6d1c5ea04af3e345232aa70c944de961061dab2d",
    "html_ref": "https://github.com/FFmpeg/FFmpeg/commit/6d1c5ea04af3e345232aa70c944de961061dab2d",
    "author": "michaelni",
    "changes_stats": {
        "total": 4,
        "additions": 2,
        "deletions": 2
    },
    "files": [
        {
            "sha": "45c247694e89ffadc156ce806195e1ce81dc4ed4",
            "filename": "libavcodec/tiff.c",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/FFmpeg/FFmpeg/blob/6d1c5ea04af3e345232aa70c944de961061dab2d/libavcodec%2Ftiff.c",
            "raw_url": "https://github.com/FFmpeg/FFmpeg/raw/6d1c5ea04af3e345232aa70c944de961061dab2d/libavcodec%2Ftiff.c",
            "contents_url": "https://api.github.com/repos/FFmpeg/FFmpeg/contents/libavcodec%2Ftiff.c?ref=6d1c5ea04af3e345232aa70c944de961061dab2d",
            "patch": "@@ -254,7 +254,7 @@ static int add_doubles_metadata(int count,\n     int i;\n     double *dp;\n \n-    if (count >= INT_MAX / sizeof(int64_t))\n+    if (count >= INT_MAX / sizeof(int64_t) || count <= 0)\n         return AVERROR_INVALIDDATA;\n     if (bytestream2_get_bytes_left(&s->gb) < count * sizeof(int64_t))\n         return AVERROR_INVALIDDATA;\n@@ -280,7 +280,7 @@ static int add_shorts_metadata(int count, const char *name,\n     int i;\n     int16_t *sp;\n \n-    if (count >= INT_MAX / sizeof(int16_t))\n+    if (count >= INT_MAX / sizeof(int16_t) || count <= 0)\n         return AVERROR_INVALIDDATA;\n     if (bytestream2_get_bytes_left(&s->gb) < count * sizeof(int16_t))\n         return AVERROR_INVALIDDATA;"
        }
    ],
    "parent_commit_sha": "ce1ebb31a9a0e556a89cd7681082af19fbc1cced"
}