{
    "owner": "qemu",
    "repo": "qemu",
    "commit_sha": "8f4754ede56e3f9ea3fd7207f4a7c4453e59285b",
    "commit_massage": "block: Limit request size (CVE-2014-0143)\n\nLimiting the size of a single request to INT_MAX not only fixes a\ndirect integer overflow in bdrv_check_request() (which would only\ntrigger bad behaviour with ridiculously huge images, as in close to\n2^64 bytes), but can also prevent overflows in all block drivers.\n\nSigned-off-by: Kevin Wolf <kwolf@redhat.com>\nReviewed-by: Max Reitz <mreitz@redhat.com>\nSigned-off-by: Stefan Hajnoczi <stefanha@redhat.com>",
    "raw_ref": "https://api.github.com/repos/qemu/qemu/commits/8f4754ede56e3f9ea3fd7207f4a7c4453e59285b",
    "html_ref": "https://github.com/qemu/qemu/commit/8f4754ede56e3f9ea3fd7207f4a7c4453e59285b",
    "author": "kevmw",
    "changes_stats": {
        "total": 4,
        "additions": 4,
        "deletions": 0
    },
    "files": [
        {
            "sha": "7a90a1b25ee217dcef2e13edaef094f58fc4a5f4",
            "filename": "block.c",
            "status": "modified",
            "additions": 4,
            "deletions": 0,
            "changes": 4,
            "blob_url": "https://github.com/qemu/qemu/blob/8f4754ede56e3f9ea3fd7207f4a7c4453e59285b/block.c",
            "raw_url": "https://github.com/qemu/qemu/raw/8f4754ede56e3f9ea3fd7207f4a7c4453e59285b/block.c",
            "contents_url": "https://api.github.com/repos/qemu/qemu/contents/block.c?ref=8f4754ede56e3f9ea3fd7207f4a7c4453e59285b",
            "patch": "@@ -2588,6 +2588,10 @@ static int bdrv_check_byte_request(BlockDriverState *bs, int64_t offset,\n static int bdrv_check_request(BlockDriverState *bs, int64_t sector_num,\n                               int nb_sectors)\n {\n+    if (nb_sectors > INT_MAX / BDRV_SECTOR_SIZE) {\n+        return -EIO;\n+    }\n+\n     return bdrv_check_byte_request(bs, sector_num * BDRV_SECTOR_SIZE,\n                                    nb_sectors * BDRV_SECTOR_SIZE);\n }"
        }
    ],
    "parent_commit_sha": "1e7226f70c9d944ae7f233b65fb4adda8f910dfe"
}