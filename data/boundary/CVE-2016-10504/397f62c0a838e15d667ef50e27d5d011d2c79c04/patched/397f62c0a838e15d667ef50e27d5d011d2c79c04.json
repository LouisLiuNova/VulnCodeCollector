{
    "owner": "uclouvain",
    "repo": "openjpeg",
    "commit_sha": "397f62c0a838e15d667ef50e27d5d011d2c79c04",
    "commit_massage": "Fix write heap buffer overflow in opj_mqc_byteout(). Discovered by Ke Liu of Tencent's Xuanwu LAB (#835)",
    "raw_ref": "https://api.github.com/repos/uclouvain/openjpeg/commits/397f62c0a838e15d667ef50e27d5d011d2c79c04",
    "html_ref": "https://github.com/uclouvain/openjpeg/commit/397f62c0a838e15d667ef50e27d5d011d2c79c04",
    "author": "rouault",
    "changes_stats": {
        "total": 5,
        "additions": 3,
        "deletions": 2
    },
    "files": [
        {
            "sha": "08c5a765a12910c26243ecaeefc2a5ad9186ec0e",
            "filename": "src/lib/openjp2/tcd.c",
            "status": "modified",
            "additions": 3,
            "deletions": 2,
            "changes": 5,
            "blob_url": "https://github.com/uclouvain/openjpeg/blob/397f62c0a838e15d667ef50e27d5d011d2c79c04/src%2Flib%2Fopenjp2%2Ftcd.c",
            "raw_url": "https://github.com/uclouvain/openjpeg/raw/397f62c0a838e15d667ef50e27d5d011d2c79c04/src%2Flib%2Fopenjp2%2Ftcd.c",
            "contents_url": "https://api.github.com/repos/uclouvain/openjpeg/contents/src%2Flib%2Fopenjp2%2Ftcd.c?ref=397f62c0a838e15d667ef50e27d5d011d2c79c04",
            "patch": "@@ -1182,8 +1182,9 @@ static OPJ_BOOL opj_tcd_code_block_enc_allocate_data(opj_tcd_cblk_enc_t *\n {\n     OPJ_UINT32 l_data_size;\n \n-    l_data_size = (OPJ_UINT32)((p_code_block->x1 - p_code_block->x0) *\n-                               (p_code_block->y1 - p_code_block->y0) * (OPJ_INT32)sizeof(OPJ_UINT32));\n+    /* The +1 is needed for https://github.com/uclouvain/openjpeg/issues/835 */\n+    l_data_size = 1 + (OPJ_UINT32)((p_code_block->x1 - p_code_block->x0) *\n+                                   (p_code_block->y1 - p_code_block->y0) * (OPJ_INT32)sizeof(OPJ_UINT32));\n \n     if (l_data_size > p_code_block->data_size) {\n         if (p_code_block->data) {"
        }
    ],
    "parent_commit_sha": "11445eddad7e7fa5b273d1c83c91011c44e5d586"
}