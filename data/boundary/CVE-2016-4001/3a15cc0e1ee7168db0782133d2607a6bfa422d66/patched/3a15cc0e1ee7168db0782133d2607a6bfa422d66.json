{
    "owner": "qemu",
    "repo": "qemu",
    "commit_sha": "3a15cc0e1ee7168db0782133d2607a6bfa422d66",
    "commit_massage": "net: stellaris_enet: check packet length against receive buffer\n\nWhen receiving packets over Stellaris ethernet controller, it\nuses receive buffer of size 2048 bytes. In case the controller\naccepts large(MTU) packets, it could lead to memory corruption.\nAdd check to avoid it.\n\nReported-by: Oleksandr Bazhaniuk <oleksandr.bazhaniuk@intel.com>\nSigned-off-by: Prasad J Pandit <pjp@fedoraproject.org>\nMessage-id: 1460095428-22698-1-git-send-email-ppandit@redhat.com\nReviewed-by: Peter Maydell <peter.maydell@linaro.org>\nSigned-off-by: Peter Maydell <peter.maydell@linaro.org>",
    "raw_ref": "https://api.github.com/repos/qemu/qemu/commits/3a15cc0e1ee7168db0782133d2607a6bfa422d66",
    "html_ref": "https://github.com/qemu/qemu/commit/3a15cc0e1ee7168db0782133d2607a6bfa422d66",
    "author": "Prasad J Pandit",
    "changes_stats": {
        "total": 12,
        "additions": 11,
        "deletions": 1
    },
    "files": [
        {
            "sha": "6880894945432a104d6d7a0fa5b4d12972fe7ed6",
            "filename": "hw/net/stellaris_enet.c",
            "status": "modified",
            "additions": 11,
            "deletions": 1,
            "changes": 12,
            "blob_url": "https://github.com/qemu/qemu/blob/3a15cc0e1ee7168db0782133d2607a6bfa422d66/hw%2Fnet%2Fstellaris_enet.c",
            "raw_url": "https://github.com/qemu/qemu/raw/3a15cc0e1ee7168db0782133d2607a6bfa422d66/hw%2Fnet%2Fstellaris_enet.c",
            "contents_url": "https://api.github.com/repos/qemu/qemu/contents/hw%2Fnet%2Fstellaris_enet.c?ref=3a15cc0e1ee7168db0782133d2607a6bfa422d66",
            "patch": "@@ -236,8 +236,18 @@ static ssize_t stellaris_enet_receive(NetClientState *nc, const uint8_t *buf, si\n     n = s->next_packet + s->np;\n     if (n >= 31)\n         n -= 31;\n-    s->np++;\n \n+    if (size >= sizeof(s->rx[n].data) - 6) {\n+        /* If the packet won't fit into the\n+         * emulated 2K RAM, this is reported\n+         * as a FIFO overrun error.\n+         */\n+        s->ris |= SE_INT_FOV;\n+        stellaris_enet_update(s);\n+        return -1;\n+    }\n+\n+    s->np++;\n     s->rx[n].len = size + 6;\n     p = s->rx[n].data;\n     *(p++) = (size + 6);"
        }
    ],
    "parent_commit_sha": "5144fe36056d3a94b0d8da9e10adc555c057baa8"
}