{
    "owner": "qemu",
    "repo": "qemu",
    "commit_sha": "a0d1cbdacff5df4ded16b753b38fdd9da6092968",
    "commit_massage": "hw/net: Fix a heap overflow in xlnx.xps-ethernetlite\n\nThe .receive callback of xlnx.xps-ethernetlite doesn't check the length\nof data before calling memcpy. As a result, the NetClientState object in\nheap will be overflowed. All versions of qemu with xlnx.xps-ethernetlite\nwill be affected.\n\nReported-by: chaojianhu <chaojianhu@hotmail.com>\nSigned-off-by: chaojianhu <chaojianhu@hotmail.com>\nSigned-off-by: Jason Wang <jasowang@redhat.com>",
    "raw_ref": "https://api.github.com/repos/qemu/qemu/commits/a0d1cbdacff5df4ded16b753b38fdd9da6092968",
    "html_ref": "https://github.com/qemu/qemu/commit/a0d1cbdacff5df4ded16b753b38fdd9da6092968",
    "author": "chaojianhu",
    "changes_stats": {
        "total": 4,
        "additions": 4,
        "deletions": 0
    },
    "files": [
        {
            "sha": "35de353b7c44bbd7518b9e68b2f7433e2703d72f",
            "filename": "hw/net/xilinx_ethlite.c",
            "status": "modified",
            "additions": 4,
            "deletions": 0,
            "changes": 4,
            "blob_url": "https://github.com/qemu/qemu/blob/a0d1cbdacff5df4ded16b753b38fdd9da6092968/hw%2Fnet%2Fxilinx_ethlite.c",
            "raw_url": "https://github.com/qemu/qemu/raw/a0d1cbdacff5df4ded16b753b38fdd9da6092968/hw%2Fnet%2Fxilinx_ethlite.c",
            "contents_url": "https://api.github.com/repos/qemu/qemu/contents/hw%2Fnet%2Fxilinx_ethlite.c?ref=a0d1cbdacff5df4ded16b753b38fdd9da6092968",
            "patch": "@@ -197,6 +197,10 @@ static ssize_t eth_rx(NetClientState *nc, const uint8_t *buf, size_t size)\n     }\n \n     D(qemu_log(\"%s %zd rxbase=%x\\n\", __func__, size, rxbase));\n+    if (size > (R_MAX - R_RX_BUF0 - rxbase) * 4) {\n+        D(qemu_log(\"ethlite packet is too big, size=%x\\n\", size));\n+        return -1;\n+    }\n     memcpy(&s->regs[rxbase + R_RX_BUF0], buf, size);\n \n     s->regs[rxbase + R_RX_CTRL0] |= CTRL_S;"
        }
    ],
    "parent_commit_sha": "6c352ca9b4ee3e1e286ea9e8434bd8e69ac7d0d8"
}