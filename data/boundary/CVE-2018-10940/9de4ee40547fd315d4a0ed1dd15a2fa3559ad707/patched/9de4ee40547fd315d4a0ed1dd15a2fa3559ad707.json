{
    "owner": "torvalds",
    "repo": "linux",
    "commit_sha": "9de4ee40547fd315d4a0ed1dd15a2fa3559ad707",
    "commit_massage": "cdrom: information leak in cdrom_ioctl_media_changed()\n\nThis cast is wrong.  \"cdi->capacity\" is an int and \"arg\" is an unsigned\nlong.  The way the check is written now, if one of the high 32 bits is\nset then we could read outside the info->slots[] array.\n\nThis bug is pretty old and it predates git.\n\nReviewed-by: Christoph Hellwig <hch@lst.de>\nCc: stable@vger.kernel.org\nSigned-off-by: Dan Carpenter <dan.carpenter@oracle.com>\nSigned-off-by: Jens Axboe <axboe@kernel.dk>",
    "raw_ref": "https://api.github.com/repos/torvalds/linux/commits/9de4ee40547fd315d4a0ed1dd15a2fa3559ad707",
    "html_ref": "https://github.com/torvalds/linux/commit/9de4ee40547fd315d4a0ed1dd15a2fa3559ad707",
    "author": "Dan Carpenter",
    "changes_stats": {
        "total": 2,
        "additions": 1,
        "deletions": 1
    },
    "files": [
        {
            "sha": "bfc566d3f31a40cf5b89d9284b2538644af68dee",
            "filename": "drivers/cdrom/cdrom.c",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/torvalds/linux/blob/9de4ee40547fd315d4a0ed1dd15a2fa3559ad707/drivers%2Fcdrom%2Fcdrom.c",
            "raw_url": "https://github.com/torvalds/linux/raw/9de4ee40547fd315d4a0ed1dd15a2fa3559ad707/drivers%2Fcdrom%2Fcdrom.c",
            "contents_url": "https://api.github.com/repos/torvalds/linux/contents/drivers%2Fcdrom%2Fcdrom.c?ref=9de4ee40547fd315d4a0ed1dd15a2fa3559ad707",
            "patch": "@@ -2371,7 +2371,7 @@ static int cdrom_ioctl_media_changed(struct cdrom_device_info *cdi,\n \tif (!CDROM_CAN(CDC_SELECT_DISC) || arg == CDSL_CURRENT)\n \t\treturn media_changed(cdi, 1);\n \n-\tif ((unsigned int)arg >= cdi->capacity)\n+\tif (arg >= cdi->capacity)\n \t\treturn -EINVAL;\n \n \tinfo = kmalloc(sizeof(*info), GFP_KERNEL);"
        }
    ],
    "parent_commit_sha": "72961c4e6082be79825265d9193272b8a1634dec"
}