{
    "owner": "ImageMagick",
    "repo": "ImageMagick",
    "commit_sha": "c6ad94fbb7b280f39c2fbbdc1c140e51b1b466e9",
    "commit_massage": "https://github.com/ImageMagick/ImageMagick/issues/3540",
    "raw_ref": "https://api.github.com/repos/ImageMagick/ImageMagick/commits/c6ad94fbb7b280f39c2fbbdc1c140e51b1b466e9",
    "html_ref": "https://github.com/ImageMagick/ImageMagick/commit/c6ad94fbb7b280f39c2fbbdc1c140e51b1b466e9",
    "author": "Cristy",
    "changes_stats": {
        "total": 10,
        "additions": 5,
        "deletions": 5
    },
    "files": [
        {
            "sha": "c6a56f3bcb6a38a443caf58b8b69e5e839c4ec65",
            "filename": "coders/tiff.c",
            "status": "modified",
            "additions": 5,
            "deletions": 5,
            "changes": 10,
            "blob_url": "https://github.com/ImageMagick/ImageMagick/blob/c6ad94fbb7b280f39c2fbbdc1c140e51b1b466e9/coders%2Ftiff.c",
            "raw_url": "https://github.com/ImageMagick/ImageMagick/raw/c6ad94fbb7b280f39c2fbbdc1c140e51b1b466e9/coders%2Ftiff.c",
            "contents_url": "https://api.github.com/repos/ImageMagick/ImageMagick/contents/coders%2Ftiff.c?ref=c6ad94fbb7b280f39c2fbbdc1c140e51b1b466e9",
            "patch": "@@ -1360,6 +1360,11 @@ static Image *ReadTIFFImage(const ImageInfo *image_info,\n         TIFFClose(tiff);\n         ThrowReaderException(CorruptImageError,\"UnsupportedBitsPerPixel\");\n       }\n+    if (samples_per_pixel > MaxPixelChannels)\n+      {\n+        TIFFClose(tiff);\n+        ThrowReaderException(CorruptImageError,\"MaximumChannelsExceeded\");\n+      }\n     if (sample_format == SAMPLEFORMAT_IEEEFP)\n       (void) SetImageProperty(image,\"quantum:format\",\"floating-point\",\n         exception);\n@@ -1728,11 +1733,6 @@ static Image *ReadTIFFImage(const ImageInfo *image_info,\n       }\n     if (image->alpha_trait != UndefinedPixelTrait)\n       (void) SetImageAlphaChannel(image,OpaqueAlphaChannel,exception);\n-    if (samples_per_pixel > MaxPixelChannels)\n-      {\n-        TIFFClose(tiff);\n-        ThrowReaderException(CorruptImageError,\"MaximumChannelsExceeded\");\n-      }\n     method=ReadGenericMethod;\n     rows_per_strip=(uint32) image->rows;\n     if (TIFFGetField(tiff,TIFFTAG_ROWSPERSTRIP,&rows_per_strip) == 1)"
        }
    ],
    "parent_commit_sha": "74fb410f055fccce104a181b525a4dfc74c3b3f7"
}