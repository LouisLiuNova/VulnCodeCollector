{
    "owner": "ImageMagick",
    "repo": "ImageMagick6",
    "commit_sha": "cd7f9fb7751b0d59d5a74b12d971155caad5a792",
    "commit_massage": "https://github.com/ImageMagick/ImageMagick/issues/3540",
    "raw_ref": "https://api.github.com/repos/ImageMagick/ImageMagick6/commits/cd7f9fb7751b0d59d5a74b12d971155caad5a792",
    "html_ref": "https://github.com/ImageMagick/ImageMagick6/commit/cd7f9fb7751b0d59d5a74b12d971155caad5a792",
    "author": "Cristy",
    "changes_stats": {
        "total": 10,
        "additions": 5,
        "deletions": 5
    },
    "files": [
        {
            "sha": "d8fbad1ebcf024fd58ff9f82797f484119c99c6b",
            "filename": "coders/tiff.c",
            "status": "modified",
            "additions": 5,
            "deletions": 5,
            "changes": 10,
            "blob_url": "https://github.com/ImageMagick/ImageMagick6/blob/cd7f9fb7751b0d59d5a74b12d971155caad5a792/coders%2Ftiff.c",
            "raw_url": "https://github.com/ImageMagick/ImageMagick6/raw/cd7f9fb7751b0d59d5a74b12d971155caad5a792/coders%2Ftiff.c",
            "contents_url": "https://api.github.com/repos/ImageMagick/ImageMagick6/contents/coders%2Ftiff.c?ref=cd7f9fb7751b0d59d5a74b12d971155caad5a792",
            "patch": "@@ -1245,6 +1245,11 @@ static Image *ReadTIFFImage(const ImageInfo *image_info,\n         TIFFClose(tiff);\n         ThrowReaderException(CorruptImageError,\"UnsupportedBitsPerPixel\");\n       }\n+    if (samples_per_pixel > MaxPixelChannels)\n+      {\n+        TIFFClose(tiff);\n+        ThrowReaderException(CorruptImageError,\"MaximumChannelsExceeded\");\n+      }\n     if (sample_format == SAMPLEFORMAT_IEEEFP)\n       (void) SetImageProperty(image,\"quantum:format\",\"floating-point\");\n     switch (photometric)\n@@ -1617,11 +1622,6 @@ static Image *ReadTIFFImage(const ImageInfo *image_info,\n       }\n     if (image->matte != MagickFalse)\n       (void) SetImageAlphaChannel(image,OpaqueAlphaChannel);\n-    if (samples_per_pixel > MaxPixelChannels)\n-      {\n-        TIFFClose(tiff);\n-        ThrowReaderException(CorruptImageError,\"MaximumChannelsExceeded\");\n-      }\n     method=ReadGenericMethod;\n     rows_per_strip=(uint32) image->rows;\n     if (TIFFGetField(tiff,TIFFTAG_ROWSPERSTRIP,&rows_per_strip) == 1)"
        }
    ],
    "parent_commit_sha": "24030ed4a3009bac808989e4142942074308bd33"
}