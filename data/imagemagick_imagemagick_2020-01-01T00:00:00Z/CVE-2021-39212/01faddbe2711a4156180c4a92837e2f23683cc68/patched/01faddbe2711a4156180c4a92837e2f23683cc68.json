{
    "owner": "ImageMagick",
    "repo": "ImageMagick",
    "commit_sha": "01faddbe2711a4156180c4a92837e2f23683cc68",
    "commit_massage": "Use the correct rights.",
    "raw_ref": "https://api.github.com/repos/ImageMagick/ImageMagick/commits/01faddbe2711a4156180c4a92837e2f23683cc68",
    "html_ref": "https://github.com/ImageMagick/ImageMagick/commit/01faddbe2711a4156180c4a92837e2f23683cc68",
    "author": "dlemstra",
    "changes_stats": {
        "total": 10,
        "additions": 7,
        "deletions": 3
    },
    "files": [
        {
            "sha": "0e568bdd508552a67679b7872bb85dffc515981d",
            "filename": "MagickCore/module.c",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/ImageMagick/ImageMagick/blob/01faddbe2711a4156180c4a92837e2f23683cc68/MagickCore%2Fmodule.c",
            "raw_url": "https://github.com/ImageMagick/ImageMagick/raw/01faddbe2711a4156180c4a92837e2f23683cc68/MagickCore%2Fmodule.c",
            "contents_url": "https://api.github.com/repos/ImageMagick/ImageMagick/contents/MagickCore%2Fmodule.c?ref=01faddbe2711a4156180c4a92837e2f23683cc68",
            "patch": "@@ -1255,7 +1255,7 @@ MagickPrivate MagickBooleanType OpenModule(const char *module,\n   p=GetCoderInfo(module,exception);\n   if (p != (CoderInfo *) NULL)\n     (void) CopyMagickString(module_name,p->name,MagickPathExtent);\n-  rights=AllPolicyRights;\n+  rights=ReadPolicyRights|WritePolicyRights;\n   if (IsRightsAuthorized(ModulePolicyDomain,rights,module_name) == MagickFalse)\n     {\n       errno=EPERM;"
        },
        {
            "sha": "0101d633d17b673420de022d0fd2f7a70634ace0",
            "filename": "MagickCore/static.c",
            "status": "modified",
            "additions": 6,
            "deletions": 2,
            "changes": 8,
            "blob_url": "https://github.com/ImageMagick/ImageMagick/blob/01faddbe2711a4156180c4a92837e2f23683cc68/MagickCore%2Fstatic.c",
            "raw_url": "https://github.com/ImageMagick/ImageMagick/raw/01faddbe2711a4156180c4a92837e2f23683cc68/MagickCore%2Fstatic.c",
            "contents_url": "https://api.github.com/repos/ImageMagick/ImageMagick/contents/MagickCore%2Fstatic.c?ref=01faddbe2711a4156180c4a92837e2f23683cc68",
            "patch": "@@ -240,7 +240,7 @@ MagickExport MagickBooleanType RegisterStaticModule(const char *module,\n   p=GetCoderInfo(module,exception);\n   if (p != (CoderInfo *) NULL)\n     (void) CopyMagickString(module_name,p->name,MagickPathExtent);\n-  rights=AllPolicyRights;\n+  rights=ReadPolicyRights|WritePolicyRights;\n   if (IsRightsAuthorized(ModulePolicyDomain,rights,module_name) == MagickFalse)\n     {\n       errno=EPERM;\n@@ -283,18 +283,22 @@ MagickExport MagickBooleanType RegisterStaticModule(const char *module,\n */\n MagickExport void RegisterStaticModules(void)\n {\n+  PolicyRights\n+    rights;\n+\n   size_t\n     extent;\n \n   ssize_t\n     i;\n \n+  rights=ReadPolicyRights|WritePolicyRights;\n   extent=sizeof(MagickModules)/sizeof(MagickModules[0]);\n   for (i=0; i < (ssize_t) extent; i++)\n   {\n     if (MagickModules[i].registered == MagickFalse)\n       {\n-        if (IsRightsAuthorized(ModulePolicyDomain,AllPolicyRights,\n+        if (IsRightsAuthorized(ModulePolicyDomain,rights,\n               MagickModules[i].module) == MagickFalse)\n           continue;\n         (void) (MagickModules[i].register_module)();"
        }
    ],
    "parent_commit_sha": "8fa069797945f7b6e64b33cad4780311ff1b4ad5"
}