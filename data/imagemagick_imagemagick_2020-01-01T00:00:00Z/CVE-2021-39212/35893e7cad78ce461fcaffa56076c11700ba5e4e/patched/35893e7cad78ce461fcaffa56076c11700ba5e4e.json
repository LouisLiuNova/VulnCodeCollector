{
    "owner": "ImageMagick",
    "repo": "ImageMagick",
    "commit_sha": "35893e7cad78ce461fcaffa56076c11700ba5e4e",
    "commit_massage": "Added missing policy checks in RegisterStaticModules.",
    "raw_ref": "https://api.github.com/repos/ImageMagick/ImageMagick/commits/35893e7cad78ce461fcaffa56076c11700ba5e4e",
    "html_ref": "https://github.com/ImageMagick/ImageMagick/commit/35893e7cad78ce461fcaffa56076c11700ba5e4e",
    "author": "dlemstra",
    "changes_stats": {
        "total": 5,
        "additions": 4,
        "deletions": 1
    },
    "files": [
        {
            "sha": "120c39e3c81965c6fd97339d1b5b424a2b3ce03b",
            "filename": "MagickCore/static.c",
            "status": "modified",
            "additions": 4,
            "deletions": 1,
            "changes": 5,
            "blob_url": "https://github.com/ImageMagick/ImageMagick/blob/35893e7cad78ce461fcaffa56076c11700ba5e4e/MagickCore%2Fstatic.c",
            "raw_url": "https://github.com/ImageMagick/ImageMagick/raw/35893e7cad78ce461fcaffa56076c11700ba5e4e/MagickCore%2Fstatic.c",
            "contents_url": "https://api.github.com/repos/ImageMagick/ImageMagick/contents/MagickCore%2Fstatic.c?ref=35893e7cad78ce461fcaffa56076c11700ba5e4e",
            "patch": "@@ -240,7 +240,7 @@ MagickExport MagickBooleanType RegisterStaticModule(const char *module,\n   p=GetCoderInfo(module,exception);\n   if (p != (CoderInfo *) NULL)\n     (void) CopyMagickString(module_name,p->name,MagickPathExtent);\n-  rights=ReadPolicyRights;\n+  rights=AllPolicyRights;\n   if (IsRightsAuthorized(ModulePolicyDomain,rights,module_name) == MagickFalse)\n     {\n       errno=EPERM;\n@@ -294,6 +294,9 @@ MagickExport void RegisterStaticModules(void)\n   {\n     if (MagickModules[i].registered == MagickFalse)\n       {\n+        if (IsRightsAuthorized(ModulePolicyDomain,AllPolicyRights,\n+              MagickModules[i].module) == MagickFalse)\n+          continue;\n         (void) (MagickModules[i].register_module)();\n         MagickModules[i].registered=MagickTrue;\n       }"
        }
    ],
    "parent_commit_sha": "d2a2f1ca5917cfbdfa188b0a8a534061659db2cb"
}