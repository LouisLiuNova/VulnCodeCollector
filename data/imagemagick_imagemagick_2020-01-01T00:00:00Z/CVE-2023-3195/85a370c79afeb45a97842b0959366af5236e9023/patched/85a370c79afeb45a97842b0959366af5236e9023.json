{
    "owner": "ImageMagick",
    "repo": "ImageMagick6",
    "commit_sha": "85a370c79afeb45a97842b0959366af5236e9023",
    "commit_massage": "fix stack overflow when parsing malicious tiff image",
    "raw_ref": "https://api.github.com/repos/ImageMagick/ImageMagick6/commits/85a370c79afeb45a97842b0959366af5236e9023",
    "html_ref": "https://github.com/ImageMagick/ImageMagick6/commit/85a370c79afeb45a97842b0959366af5236e9023",
    "author": "Cristy",
    "changes_stats": {
        "total": 7,
        "additions": 7,
        "deletions": 0
    },
    "files": [
        {
            "sha": "1687a04ca6b5d7d071371992ffa3dfeb09a6ffcf",
            "filename": "ChangeLog",
            "status": "modified",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/ImageMagick/ImageMagick6/blob/85a370c79afeb45a97842b0959366af5236e9023/ChangeLog",
            "raw_url": "https://github.com/ImageMagick/ImageMagick6/raw/85a370c79afeb45a97842b0959366af5236e9023/ChangeLog",
            "contents_url": "https://api.github.com/repos/ImageMagick/ImageMagick6/contents/ChangeLog?ref=85a370c79afeb45a97842b0959366af5236e9023",
            "patch": "@@ -6,6 +6,8 @@\n     https://github.com/ImageMagick/ImageMagick/issues/4372).\n   * fix possible unitialized values (reference\n     https://github.com/ImageMagick/ImageMagick/issues/4379).\n+  * fix stack overflow when parsing malicious tiff image file (report from\n+    Muhammad Aldo Firmansyah).\n \n 2021-10-10  6.9.12-25  <quetzlzacatenango@image...>\n   * Release ImageMagick version 6.9.12-25 GIT revision 16849:2c96ab5d0:20211010"
        },
        {
            "sha": "8c89fd9e109e6ec0687a0e465a6963936d6279bf",
            "filename": "coders/tiff.c",
            "status": "modified",
            "additions": 5,
            "deletions": 0,
            "changes": 5,
            "blob_url": "https://github.com/ImageMagick/ImageMagick6/blob/85a370c79afeb45a97842b0959366af5236e9023/coders%2Ftiff.c",
            "raw_url": "https://github.com/ImageMagick/ImageMagick6/raw/85a370c79afeb45a97842b0959366af5236e9023/coders%2Ftiff.c",
            "contents_url": "https://api.github.com/repos/ImageMagick/ImageMagick6/contents/coders%2Ftiff.c?ref=85a370c79afeb45a97842b0959366af5236e9023",
            "patch": "@@ -1892,6 +1892,11 @@ static Image *ReadTIFFImage(const ImageInfo *image_info,\n         if (HeapOverflowSanityCheck(rows,sizeof(*tile_pixels)) != MagickFalse)\n           ThrowTIFFException(ResourceLimitError,\"MemoryAllocationFailed\");\n         extent=MagickMax(rows*TIFFTileRowSize(tiff),TIFFTileSize(tiff));\n+#if defined(TIFF_VERSION_BIG)\n+        extent+=image->columns*sizeof(uint64);\n+#else\n+        extent+=image->columns*sizeof(uint32);\n+#endif\n         tile_pixels=(unsigned char *) AcquireQuantumMemory(extent,\n           sizeof(*tile_pixels));\n         if (tile_pixels == (unsigned char *) NULL)"
        }
    ],
    "parent_commit_sha": "01e79c207608bb7eacd4b6710663213773684dcd"
}