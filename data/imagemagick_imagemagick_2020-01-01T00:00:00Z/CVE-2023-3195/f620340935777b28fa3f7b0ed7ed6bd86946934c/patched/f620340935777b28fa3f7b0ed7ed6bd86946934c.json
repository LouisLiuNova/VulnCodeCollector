{
    "owner": "ImageMagick",
    "repo": "ImageMagick",
    "commit_sha": "f620340935777b28fa3f7b0ed7ed6bd86946934c",
    "commit_massage": "fix stack overflow when parsing malicious tiff image",
    "raw_ref": "https://api.github.com/repos/ImageMagick/ImageMagick/commits/f620340935777b28fa3f7b0ed7ed6bd86946934c",
    "html_ref": "https://github.com/ImageMagick/ImageMagick/commit/f620340935777b28fa3f7b0ed7ed6bd86946934c",
    "author": "Cristy",
    "changes_stats": {
        "total": 7,
        "additions": 7,
        "deletions": 0
    },
    "files": [
        {
            "sha": "c2477c457cddaf9f9451c1eacf9e124ceccdcdb1",
            "filename": "ChangeLog",
            "status": "modified",
            "additions": 2,
            "deletions": 0,
            "changes": 2,
            "blob_url": "https://github.com/ImageMagick/ImageMagick/blob/f620340935777b28fa3f7b0ed7ed6bd86946934c/ChangeLog",
            "raw_url": "https://github.com/ImageMagick/ImageMagick/raw/f620340935777b28fa3f7b0ed7ed6bd86946934c/ChangeLog",
            "contents_url": "https://api.github.com/repos/ImageMagick/ImageMagick/contents/ChangeLog?ref=f620340935777b28fa3f7b0ed7ed6bd86946934c",
            "patch": "@@ -6,6 +6,8 @@\n     https://github.com/ImageMagick/ImageMagick/issues/4372).\n   * fix possible unitialized values (reference\n     https://github.com/ImageMagick/ImageMagick/issues/4379).\n+  * fix stack overflow when parsing malicious tiff image file (report from\n+    Muhammad Aldo Firmansyah).\n \n 2021-10-10  7.1.0-10  <quetzlzacatenango@image...>\n   * Release ImageMagick version 7.1.0-10 GIT revision 19236:07ebe6b6e:20211010"
        },
        {
            "sha": "81f50082fd17cc788ac3c57b843a4a2a9722f596",
            "filename": "coders/tiff.c",
            "status": "modified",
            "additions": 5,
            "deletions": 0,
            "changes": 5,
            "blob_url": "https://github.com/ImageMagick/ImageMagick/blob/f620340935777b28fa3f7b0ed7ed6bd86946934c/coders%2Ftiff.c",
            "raw_url": "https://github.com/ImageMagick/ImageMagick/raw/f620340935777b28fa3f7b0ed7ed6bd86946934c/coders%2Ftiff.c",
            "contents_url": "https://api.github.com/repos/ImageMagick/ImageMagick/contents/coders%2Ftiff.c?ref=f620340935777b28fa3f7b0ed7ed6bd86946934c",
            "patch": "@@ -2001,6 +2001,11 @@ static Image *ReadTIFFImage(const ImageInfo *image_info,\n         if (HeapOverflowSanityCheck(rows,sizeof(*tile_pixels)) != MagickFalse)\n           ThrowTIFFException(ResourceLimitError,\"MemoryAllocationFailed\");\n         extent=MagickMax(rows*TIFFTileRowSize(tiff),TIFFTileSize(tiff));\n+#if defined(TIFF_VERSION_BIG)\n+        extent+=image->columns*sizeof(uint64);\n+#else\n+        extent+=image->columns*sizeof(uint32);\n+#endif\n         tile_pixels=(unsigned char *) AcquireQuantumMemory(extent,\n           sizeof(*tile_pixels));\n         if (tile_pixels == (unsigned char *) NULL)"
        }
    ],
    "parent_commit_sha": "18e15da2dc6ceae05e95077f85e9d67dac31c5d8"
}