{
    "owner": "ImageMagick",
    "repo": "ImageMagick",
    "commit_sha": "1061db7f80fdc9ef572ac60b55f408f7bab6e1b0",
    "commit_massage": "carefully crafted image files (TIM2, JPEG) no longer overflow buffer nor use heap after free (thanks to Juzhi Lu, Zhen Zhou, Likang Luo of NSFOCUS Security Team)",
    "raw_ref": "https://api.github.com/repos/ImageMagick/ImageMagick/commits/1061db7f80fdc9ef572ac60b55f408f7bab6e1b0",
    "html_ref": "https://github.com/ImageMagick/ImageMagick/commit/1061db7f80fdc9ef572ac60b55f408f7bab6e1b0",
    "author": "Cristy",
    "changes_stats": {
        "total": 9,
        "additions": 6,
        "deletions": 3
    },
    "files": [
        {
            "sha": "382583a524852a3a87b8f42623ad9a4f3e7fda51",
            "filename": "MagickCore/profile.c",
            "status": "modified",
            "additions": 3,
            "deletions": 2,
            "changes": 5,
            "blob_url": "https://github.com/ImageMagick/ImageMagick/blob/1061db7f80fdc9ef572ac60b55f408f7bab6e1b0/MagickCore%2Fprofile.c",
            "raw_url": "https://github.com/ImageMagick/ImageMagick/raw/1061db7f80fdc9ef572ac60b55f408f7bab6e1b0/MagickCore%2Fprofile.c",
            "contents_url": "https://api.github.com/repos/ImageMagick/ImageMagick/contents/MagickCore%2Fprofile.c?ref=1061db7f80fdc9ef572ac60b55f408f7bab6e1b0",
            "patch": "@@ -2458,11 +2458,12 @@ static void ReplaceXmpValue(StringInfo *profile,size_t start,size_t end,\n   if (new_length > length)\n     SetStringInfoLength(profile,new_length);\n   datum=(char *) GetStringInfoDatum(profile);\n-  memmove(datum+start+value_length,datum+end,length-end);\n-  memcpy(datum+start,value,value_length);\n+  (void) memmove(datum+start+value_length,datum+end,length-end);\n+  (void) memcpy(datum+start,value,value_length);\n   if (new_length < length)\n     {\n       SetStringInfoLength(profile,new_length);\n+      datum=(char *) GetStringInfoDatum(profile);\n       *(datum+new_length)='\\0';\n     }\n }"
        },
        {
            "sha": "d30afaf05d6b53e79489c4d85d7c194cf380ffb0",
            "filename": "coders/tim2.c",
            "status": "modified",
            "additions": 3,
            "deletions": 1,
            "changes": 4,
            "blob_url": "https://github.com/ImageMagick/ImageMagick/blob/1061db7f80fdc9ef572ac60b55f408f7bab6e1b0/coders%2Ftim2.c",
            "raw_url": "https://github.com/ImageMagick/ImageMagick/raw/1061db7f80fdc9ef572ac60b55f408f7bab6e1b0/coders%2Ftim2.c",
            "contents_url": "https://api.github.com/repos/ImageMagick/ImageMagick/contents/coders%2Ftim2.c?ref=1061db7f80fdc9ef572ac60b55f408f7bab6e1b0",
            "patch": "@@ -517,10 +517,12 @@ static MagickBooleanType ReadTIM2ImageData(const ImageInfo *image_info,\n     /*\n       * ### Read CLUT Data ###\n       */\n-    clut_data=(unsigned char *) AcquireQuantumMemory(1,header->clut_size);\n+    clut_data=(unsigned char *) AcquireQuantumMemory(2,\n+      MagickMax(header->clut_size,image->colors));\n     if (clut_data == (unsigned char *) NULL)\n       ThrowBinaryException(ResourceLimitError,\"MemoryAllocationFailed\",\n         image_info->filename);\n+    (void) memset(clut_data,0,2*MagickMax(header->clut_size,image->colors));\n     count=ReadBlob(image,header->clut_size,clut_data);\n     if (count != (ssize_t) (header->clut_size))\n       {"
        }
    ],
    "parent_commit_sha": "e31343f0153b3871985aa1deaab446d8d58197f2"
}