{
    "owner": "ImageMagick",
    "repo": "ImageMagick",
    "commit_sha": "aa673b2e4defc7cad5bec16c4fc8324f71e531f1",
    "commit_massage": "check for BMP file size, poc provided by Hardik Shah of Vehere (Dawn Treaders team)",
    "raw_ref": "https://api.github.com/repos/ImageMagick/ImageMagick/commits/aa673b2e4defc7cad5bec16c4fc8324f71e531f1",
    "html_ref": "https://github.com/ImageMagick/ImageMagick/commit/aa673b2e4defc7cad5bec16c4fc8324f71e531f1",
    "author": "Cristy",
    "changes_stats": {
        "total": 3,
        "additions": 3,
        "deletions": 0
    },
    "files": [
        {
            "sha": "7e36d4f481b9f6a7c1cd5fc0f801f14466a01a8e",
            "filename": "coders/bmp.c",
            "status": "modified",
            "additions": 3,
            "deletions": 0,
            "changes": 3,
            "blob_url": "https://github.com/ImageMagick/ImageMagick/blob/aa673b2e4defc7cad5bec16c4fc8324f71e531f1/coders%2Fbmp.c",
            "raw_url": "https://github.com/ImageMagick/ImageMagick/raw/aa673b2e4defc7cad5bec16c4fc8324f71e531f1/coders%2Fbmp.c",
            "contents_url": "https://api.github.com/repos/ImageMagick/ImageMagick/contents/coders%2Fbmp.c?ref=aa673b2e4defc7cad5bec16c4fc8324f71e531f1",
            "patch": "@@ -695,6 +695,9 @@ static Image *ReadBMPImage(const ImageInfo *image_info,ExceptionInfo *exception)\n       }\n     if (bmp_info.size > 124)\n       ThrowReaderException(CorruptImageError,\"ImproperImageHeader\");\n+    if ((bmp_info.file_size != 0) &&\n+        ((MagickSizeType) bmp_info.file_size > GetBlobSize(image)))\n+      ThrowReaderException(CorruptImageError,\"ImproperImageHeader\");\n     if (bmp_info.offset_bits < bmp_info.size)\n       ThrowReaderException(CorruptImageError,\"ImproperImageHeader\");\n     bmp_info.offset_bits=MagickMax(14+bmp_info.size,bmp_info.offset_bits);"
        }
    ],
    "parent_commit_sha": "a0b5ea709626bd9054dca75bc02de461f69410c1"
}