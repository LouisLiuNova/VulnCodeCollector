{
    "owner": "torvalds",
    "repo": "linux",
    "commit_sha": "3feec9095d12e311b7d4eb7fe7e5dfa75d4a72a5",
    "commit_massage": "l2tp: Fix oops in pppol2tp_xmit\n\nWhen transmitting L2TP frames, we derive the outgoing interface's UDP\nchecksum hardware assist capabilities from the tunnel dst dev. This\ncan sometimes be NULL, especially when routing protocols are used and\nrouting changes occur. This patch just checks for NULL dst or dev\npointers when checking for netdev hardware assist features.\n\nBUG: unable to handle kernel NULL pointer dereference at 0000000c\nIP: [<f89d074c>] pppol2tp_xmit+0x341/0x4da [pppol2tp]\n*pde = 00000000\nOops: 0000 [#1] SMP\nlast sysfs file: /sys/class/net/lo/operstate\nModules linked in: pppol2tp pppox ppp_generic slhc ipv6 dummy loop snd_hda_codec_atihdmi snd_hda_intel snd_hda_codec snd_pcm snd_timer snd soundcore snd_page_alloc evdev psmouse serio_raw processor button i2c_piix4 i2c_core ati_agp agpgart pcspkr ext3 jbd mbcache sd_mod ide_pci_generic atiixp ide_core ahci ata_generic floppy ehci_hcd ohci_hcd libata e1000e scsi_mod usbcore nls_base thermal fan thermal_sys [last unloaded: scsi_wait_scan]\n\nPid: 0, comm: swapper Not tainted (2.6.32.8 #1)\nEIP: 0060:[<f89d074c>] EFLAGS: 00010297 CPU: 3\nEIP is at pppol2tp_xmit+0x341/0x4da [pppol2tp]\nEAX: 00000000 EBX: f64d1680 ECX: 000005b9 EDX: 00000000\nESI: f6b91850 EDI: f64d16ac EBP: f6a0c4c0 ESP: f70a9cac\n DS: 007b ES: 007b FS: 00d8 GS: 0000 SS: 0068\nProcess swapper (pid: 0, ti=f70a8000 task=f70a31c0 task.ti=f70a8000)\nStack:\n 000005a9 000005b9 f734c400 f66652c0 f7352e00 f67dc800 00000000 f6b91800\n<0> 000005a3 f70ef6c4 f67dcda9 000005a3 f89b192e 00000246 000005a3 f64d1680\n<0> f63633e0 f6363320 f64d1680 f65a7320 f65a7364 f65856c0 f64d1680 f679f02f\nCall Trace:\n [<f89b192e>] ? ppp_push+0x459/0x50e [ppp_generic]\n [<f89b217f>] ? ppp_xmit_process+0x3b6/0x430 [ppp_generic]\n [<f89b2306>] ? ppp_start_xmit+0x10d/0x120 [ppp_generic]\n [<c11c15cb>] ? dev_hard_start_xmit+0x21f/0x2b2\n [<c11d0947>] ? sch_direct_xmit+0x48/0x10e\n [<c11c19a0>] ? dev_queue_xmit+0x263/0x3a6\n [<c11e2a9f>] ? ip_finish_output+0x1f7/0x221\n [<c11df682>] ? ip_forward_finish+0x2e/0x30\n [<c11de645>] ? ip_rcv_finish+0x295/0x2a9\n [<c11c0b19>] ? netif_receive_skb+0x3e9/0x404\n [<f814b791>] ? e1000_clean_rx_irq+0x253/0x2fc [e1000e]\n [<f814cb7a>] ? e1000_clean+0x63/0x1fc [e1000e]\n [<c1047eff>] ? sched_clock_local+0x15/0x11b\n [<c11c1095>] ? net_rx_action+0x96/0x195\n [<c1035750>] ? __do_softirq+0xaa/0x151\n [<c1035828>] ? do_softirq+0x31/0x3c\n [<c10358fe>] ? irq_exit+0x26/0x58\n [<c1004b21>] ? do_IRQ+0x78/0x89\n [<c1003729>] ? common_interrupt+0x29/0x30\n [<c101ac28>] ? native_safe_halt+0x2/0x3\n [<c1008c54>] ? default_idle+0x55/0x75\n [<c1009045>] ? c1e_idle+0xd2/0xd5\n [<c100233c>] ? cpu_idle+0x46/0x62\nCode: 8d 45 08 f0 ff 45 08 89 6b 08 c7 43 68 7e fb 9c f8 8a 45 24 83 e0 0c 3c 04 75 09 80 63 64 f3 e9 b4 00 00 00 8b 43 18 8b 4c 24 04 <8b> 40 0c 8d 79 11 f6 40 44 0e 8a 43 64 75 51 6a 00 8b 4c 24 08\nEIP: [<f89d074c>] pppol2tp_xmit+0x341/0x4da [pppol2tp] SS:ESP 0068:f70a9cac\nCR2: 000000000000000c\n\nSigned-off-by: James Chapman <jchapman@katalix.com>\nSigned-off-by: David S. Miller <davem@davemloft.net>",
    "raw_ref": "https://api.github.com/repos/torvalds/linux/commits/3feec9095d12e311b7d4eb7fe7e5dfa75d4a72a5",
    "html_ref": "https://github.com/torvalds/linux/commit/3feec9095d12e311b7d4eb7fe7e5dfa75d4a72a5",
    "author": "j-c-h",
    "changes_stats": {
        "total": 3,
        "additions": 2,
        "deletions": 1
    },
    "files": [
        {
            "sha": "5861ee9599a2ff9a34ee0ed65590e1f538b6601d",
            "filename": "drivers/net/pppol2tp.c",
            "status": "modified",
            "additions": 2,
            "deletions": 1,
            "changes": 3,
            "blob_url": "https://github.com/torvalds/linux/blob/3feec9095d12e311b7d4eb7fe7e5dfa75d4a72a5/drivers%2Fnet%2Fpppol2tp.c",
            "raw_url": "https://github.com/torvalds/linux/raw/3feec9095d12e311b7d4eb7fe7e5dfa75d4a72a5/drivers%2Fnet%2Fpppol2tp.c",
            "contents_url": "https://api.github.com/repos/torvalds/linux/contents/drivers%2Fnet%2Fpppol2tp.c?ref=3feec9095d12e311b7d4eb7fe7e5dfa75d4a72a5",
            "patch": "@@ -1180,7 +1180,8 @@ static int pppol2tp_xmit(struct ppp_channel *chan, struct sk_buff *skb)\n \t/* Calculate UDP checksum if configured to do so */\n \tif (sk_tun->sk_no_check == UDP_CSUM_NOXMIT)\n \t\tskb->ip_summed = CHECKSUM_NONE;\n-\telse if (!(skb_dst(skb)->dev->features & NETIF_F_V4_CSUM)) {\n+\telse if ((skb_dst(skb) && skb_dst(skb)->dev) &&\n+\t\t (!(skb_dst(skb)->dev->features & NETIF_F_V4_CSUM))) {\n \t\tskb->ip_summed = CHECKSUM_COMPLETE;\n \t\tcsum = skb_checksum(skb, 0, udp_len, 0);\n \t\tuh->check = csum_tcpudp_magic(inet->inet_saddr,"
        }
    ],
    "parent_commit_sha": "d0cad871703b898a442e4049c532ec39168e5b57"
}