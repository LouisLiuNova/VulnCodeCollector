{
    "owner": "radare",
    "repo": "radare2",
    "commit_sha": "90b71c017a7fa9732fe45fd21b245ee051b1f548",
    "commit_massage": "Fix #10293 - Use-after-free in r_anal_bb_free()",
    "raw_ref": "https://api.github.com/repos/radareorg/radare2/commits/90b71c017a7fa9732fe45fd21b245ee051b1f548",
    "html_ref": "https://github.com/radareorg/radare2/commit/90b71c017a7fa9732fe45fd21b245ee051b1f548",
    "author": "radare",
    "changes_stats": {
        "total": 6,
        "additions": 5,
        "deletions": 1
    },
    "files": [
        {
            "sha": "a693c55856df26689b41121ed86457107e37602d",
            "filename": "libr/anal/bb.c",
            "status": "modified",
            "additions": 5,
            "deletions": 1,
            "changes": 6,
            "blob_url": "https://github.com/radareorg/radare2/blob/90b71c017a7fa9732fe45fd21b245ee051b1f548/libr%2Fanal%2Fbb.c",
            "raw_url": "https://github.com/radareorg/radare2/raw/90b71c017a7fa9732fe45fd21b245ee051b1f548/libr%2Fanal%2Fbb.c",
            "contents_url": "https://api.github.com/repos/radareorg/radare2/contents/libr%2Fanal%2Fbb.c?ref=90b71c017a7fa9732fe45fd21b245ee051b1f548",
            "patch": "@@ -62,7 +62,11 @@ R_API void r_anal_bb_free(RAnalBlock *bb) {\n \t\tbb->failbb->prev = NULL;\n \t\tbb->failbb = NULL;\n \t}\n-\tR_FREE (bb);\n+\tif (bb->next) {\n+\t\t// avoid double free\n+\t\tbb->next->prev = NULL;\n+\t}\n+\tR_FREE (bb); // double free\n }\n \n R_API RList *r_anal_bb_list_new() {"
        }
    ],
    "parent_commit_sha": "224e6bc13fa353dd3b7f7a2334588f1c4229e58d"
}