{
    "owner": "radare",
    "repo": "radare2",
    "commit_sha": "d31c4d3cbdbe01ea3ded16a584de94149ecd31d9",
    "commit_massage": "Fix #8748 - Fix oobread on string search",
    "raw_ref": "https://api.github.com/repos/radareorg/radare2/commits/d31c4d3cbdbe01ea3ded16a584de94149ecd31d9",
    "html_ref": "https://github.com/radareorg/radare2/commit/d31c4d3cbdbe01ea3ded16a584de94149ecd31d9",
    "author": "radare",
    "changes_stats": {
        "total": 8,
        "additions": 4,
        "deletions": 4
    },
    "files": [
        {
            "sha": "b5fffe88bc3e9f5ee64dbd0114b799a9a68acee7",
            "filename": "libr/bin/bin.c",
            "status": "modified",
            "additions": 4,
            "deletions": 4,
            "changes": 8,
            "blob_url": "https://github.com/radareorg/radare2/blob/d31c4d3cbdbe01ea3ded16a584de94149ecd31d9/libr%2Fbin%2Fbin.c",
            "raw_url": "https://github.com/radareorg/radare2/raw/d31c4d3cbdbe01ea3ded16a584de94149ecd31d9/libr%2Fbin%2Fbin.c",
            "contents_url": "https://api.github.com/repos/radareorg/radare2/contents/libr%2Fbin%2Fbin.c?ref=d31c4d3cbdbe01ea3ded16a584de94149ecd31d9",
            "patch": "@@ -352,16 +352,16 @@ static int string_scan_range(RList *list, const ut8 *buf, int min,\n \t\t\t\t// TODO: move into adjust_offset\n \t\t\t\tswitch (str_type) {\n \t\t\t\tcase R_STRING_TYPE_WIDE:\n-\t\t\t\t\t{\n-\t\t\t\t\t\tconst ut8 *p = buf  + str_start - 2;\n+\t\t\t\t\tif (str_start > 1) {\n+\t\t\t\t\t\tconst ut8 *p = buf + str_start - 2;\n \t\t\t\t\t\tif (p[0] == 0xff && p[1] == 0xfe) {\n \t\t\t\t\t\t\tstr_start -= 2; // \\xff\\xfe\n \t\t\t\t\t\t}\n \t\t\t\t\t}\n \t\t\t\t\tbreak;\n \t\t\t\tcase R_STRING_TYPE_WIDE32:\n-\t\t\t\t\t{\n-\t\t\t\t\t\tconst ut8 *p = buf  + str_start - 4;\n+\t\t\t\t\tif (str_start > 3) {\n+\t\t\t\t\t\tconst ut8 *p = buf + str_start - 4;\n \t\t\t\t\t\tif (p[0] == 0xff && p[1] == 0xfe) {\n \t\t\t\t\t\t\tstr_start -= 4; // \\xff\\xfe\\x00\\x00\n \t\t\t\t\t\t}"
        }
    ],
    "parent_commit_sha": "dc8cff2f4dd3456b546182b36e91ce060330ab02"
}