{
    "owner": "torvalds",
    "repo": "linux",
    "commit_sha": "eafe1aa37e6ec2d56f14732b5240c4dd09f0613a",
    "commit_massage": "I4L: fix isdn_ioctl memory overrun vulnerability\n\nFix possible memory overrun issue in the isdn ioctl code.\n\nFound by ADLAB <adlab@venustech.com.cn>\n\nSigned-off-by: Karsten Keil <kkeil@suse.de>\nCc: ADLAB <adlab@venustech.com.cn>\nCc: <stable@kernel.org>\nSigned-off-by: Andrew Morton <akpm@linux-foundation.org>\nSigned-off-by: Linus Torvalds <torvalds@linux-foundation.org>",
    "raw_ref": "https://api.github.com/repos/torvalds/linux/commits/eafe1aa37e6ec2d56f14732b5240c4dd09f0613a",
    "html_ref": "https://github.com/torvalds/linux/commit/eafe1aa37e6ec2d56f14732b5240c4dd09f0613a",
    "author": "Karsten Keil",
    "changes_stats": {
        "total": 5,
        "additions": 4,
        "deletions": 1
    },
    "files": [
        {
            "sha": "d6952959d72afc643be51248cadd523e2a0ebcf7",
            "filename": "drivers/isdn/i4l/isdn_common.c",
            "status": "modified",
            "additions": 4,
            "deletions": 1,
            "changes": 5,
            "blob_url": "https://github.com/torvalds/linux/blob/eafe1aa37e6ec2d56f14732b5240c4dd09f0613a/drivers%2Fisdn%2Fi4l%2Fisdn_common.c",
            "raw_url": "https://github.com/torvalds/linux/raw/eafe1aa37e6ec2d56f14732b5240c4dd09f0613a/drivers%2Fisdn%2Fi4l%2Fisdn_common.c",
            "contents_url": "https://api.github.com/repos/torvalds/linux/contents/drivers%2Fisdn%2Fi4l%2Fisdn_common.c?ref=eafe1aa37e6ec2d56f14732b5240c4dd09f0613a",
            "patch": "@@ -1515,6 +1515,7 @@ isdn_ioctl(struct inode *inode, struct file *file, uint cmd, ulong arg)\n \t\t\t\t\tif (copy_from_user(&iocts, argp,\n \t\t\t\t\t     sizeof(isdn_ioctl_struct)))\n \t\t\t\t\t\treturn -EFAULT;\n+\t\t\t\t\tiocts.drvid[sizeof(iocts.drvid)-1] = 0;\n \t\t\t\t\tif (strlen(iocts.drvid)) {\n \t\t\t\t\t\tif ((p = strchr(iocts.drvid, ',')))\n \t\t\t\t\t\t\t*p = 0;\n@@ -1599,6 +1600,7 @@ isdn_ioctl(struct inode *inode, struct file *file, uint cmd, ulong arg)\n \t\t\t\t\tif (copy_from_user(&iocts, argp,\n \t\t\t\t\t     sizeof(isdn_ioctl_struct)))\n \t\t\t\t\t\treturn -EFAULT;\n+\t\t\t\t\tiocts.drvid[sizeof(iocts.drvid)-1] = 0;\n \t\t\t\t\tif (strlen(iocts.drvid)) {\n \t\t\t\t\t\tdrvidx = -1;\n \t\t\t\t\t\tfor (i = 0; i < ISDN_MAX_DRIVERS; i++)\n@@ -1643,7 +1645,7 @@ isdn_ioctl(struct inode *inode, struct file *file, uint cmd, ulong arg)\n \t\t\t\t\t} else {\n \t\t\t\t\t\tp = (char __user *) iocts.arg;\n \t\t\t\t\t\tfor (i = 0; i < 10; i++) {\n-\t\t\t\t\t\t\tsprintf(bname, \"%s%s\",\n+\t\t\t\t\t\t\tsnprintf(bname, sizeof(bname), \"%s%s\",\n \t\t\t\t\t\t\t\tstrlen(dev->drv[drvidx]->msn2eaz[i]) ?\n \t\t\t\t\t\t\t\tdev->drv[drvidx]->msn2eaz[i] : \"_\",\n \t\t\t\t\t\t\t\t(i < 9) ? \",\" : \"\\0\");\n@@ -1673,6 +1675,7 @@ isdn_ioctl(struct inode *inode, struct file *file, uint cmd, ulong arg)\n \t\t\t\t\tchar *p;\n \t\t\t\t\tif (copy_from_user(&iocts, argp, sizeof(isdn_ioctl_struct)))\n \t\t\t\t\t\treturn -EFAULT;\n+\t\t\t\t\tiocts.drvid[sizeof(iocts.drvid)-1] = 0;\n \t\t\t\t\tif (strlen(iocts.drvid)) {\n \t\t\t\t\t\tif ((p = strchr(iocts.drvid, ',')))\n \t\t\t\t\t\t\t*p = 0;"
        }
    ],
    "parent_commit_sha": "92d499d991ec4f5cbd00d6f33967eab9d3ee8d6c"
}