{
    "owner": "torvalds",
    "repo": "linux",
    "commit_sha": "d81a12bc29ae4038770e05dce4ab7f26fd5880fb",
    "commit_massage": "sound: Prevent buffer overflow in OSS load_mixer_volumes\n\nThe load_mixer_volumes() function, which can be triggered by\nunprivileged users via the SOUND_MIXER_SETLEVELS ioctl, is vulnerable to\na buffer overflow.  Because the provided \"name\" argument isn't\nguaranteed to be NULL terminated at the expected 32 bytes, it's possible\nto overflow past the end of the last element in the mixer_vols array.\nFurther exploitation can result in an arbitrary kernel write (via\nsubsequent calls to load_mixer_volumes()) leading to privilege\nescalation, or arbitrary kernel reads via get_mixer_levels().  In\naddition, the strcmp() may leak bytes beyond the mixer_vols array.\n\nSigned-off-by: Dan Rosenberg <drosenberg@vsecurity.com>\nCc: stable <stable@kernel.org>\nSigned-off-by: Takashi Iwai <tiwai@suse.de>",
    "raw_ref": "https://api.github.com/repos/torvalds/linux/commits/d81a12bc29ae4038770e05dce4ab7f26fd5880fb",
    "html_ref": "https://github.com/torvalds/linux/commit/d81a12bc29ae4038770e05dce4ab7f26fd5880fb",
    "author": "Dan Rosenberg",
    "changes_stats": {
        "total": 4,
        "additions": 2,
        "deletions": 2
    },
    "files": [
        {
            "sha": "fcb14a09982262d473842aeb55f365b031ebeb70",
            "filename": "sound/oss/soundcard.c",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/torvalds/linux/blob/d81a12bc29ae4038770e05dce4ab7f26fd5880fb/sound%2Foss%2Fsoundcard.c",
            "raw_url": "https://github.com/torvalds/linux/raw/d81a12bc29ae4038770e05dce4ab7f26fd5880fb/sound%2Foss%2Fsoundcard.c",
            "contents_url": "https://api.github.com/repos/torvalds/linux/contents/sound%2Foss%2Fsoundcard.c?ref=d81a12bc29ae4038770e05dce4ab7f26fd5880fb",
            "patch": "@@ -87,7 +87,7 @@ int *load_mixer_volumes(char *name, int *levels, int present)\n \tint             i, n;\n \n \tfor (i = 0; i < num_mixer_volumes; i++) {\n-\t\tif (strcmp(name, mixer_vols[i].name) == 0) {\n+\t\tif (strncmp(name, mixer_vols[i].name, 32) == 0) {\n \t\t\tif (present)\n \t\t\t\tmixer_vols[i].num = i;\n \t\t\treturn mixer_vols[i].levels;\n@@ -99,7 +99,7 @@ int *load_mixer_volumes(char *name, int *levels, int present)\n \t}\n \tn = num_mixer_volumes++;\n \n-\tstrcpy(mixer_vols[n].name, name);\n+\tstrncpy(mixer_vols[n].name, name, 32);\n \n \tif (present)\n \t\tmixer_vols[n].num = n;"
        }
    ],
    "parent_commit_sha": "7693457547b729d9010a6014bbb8572b085f58d4"
}