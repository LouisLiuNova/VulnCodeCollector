{
    "owner": "torvalds",
    "repo": "linux",
    "commit_sha": "cae13fe4cc3f24820ffb990c09110626837e85d4",
    "commit_massage": "Fix for buffer overflow in ldm_frag_add not sufficient\n\nAs Ben Hutchings discovered [1], the patch for CVE-2011-1017 (buffer\noverflow in ldm_frag_add) is not sufficient.  The original patch in\ncommit c340b1d64000 (\"fs/partitions/ldm.c: fix oops caused by corrupted\npartition table\") does not consider that, for subsequent fragments,\npreviously allocated memory is used.\n\n[1] http://lkml.org/lkml/2011/5/6/407\n\nReported-by: Ben Hutchings <ben@decadent.org.uk>\nSigned-off-by: Timo Warns <warns@pre-sense.de>\nSigned-off-by: Linus Torvalds <torvalds@linux-foundation.org>",
    "raw_ref": "https://api.github.com/repos/torvalds/linux/commits/cae13fe4cc3f24820ffb990c09110626837e85d4",
    "html_ref": "https://github.com/torvalds/linux/commit/cae13fe4cc3f24820ffb990c09110626837e85d4",
    "author": "Timo Warns",
    "changes_stats": {
        "total": 5,
        "additions": 5,
        "deletions": 0
    },
    "files": [
        {
            "sha": "a29d5ccf3d54a95099a0ca250f36cbac6dbfba2c",
            "filename": "fs/partitions/ldm.c",
            "status": "modified",
            "additions": 5,
            "deletions": 0,
            "changes": 5,
            "blob_url": "https://github.com/torvalds/linux/blob/cae13fe4cc3f24820ffb990c09110626837e85d4/fs%2Fpartitions%2Fldm.c",
            "raw_url": "https://github.com/torvalds/linux/raw/cae13fe4cc3f24820ffb990c09110626837e85d4/fs%2Fpartitions%2Fldm.c",
            "contents_url": "https://api.github.com/repos/torvalds/linux/contents/fs%2Fpartitions%2Fldm.c?ref=cae13fe4cc3f24820ffb990c09110626837e85d4",
            "patch": "@@ -1335,6 +1335,11 @@ static bool ldm_frag_add (const u8 *data, int size, struct list_head *frags)\n \n \tlist_add_tail (&f->list, frags);\n found:\n+\tif (rec >= f->num) {\n+\t\tldm_error(\"REC value (%d) exceeds NUM value (%d)\", rec, f->num);\n+\t\treturn false;\n+\t}\n+\n \tif (f->map & (1 << rec)) {\n \t\tldm_error (\"Duplicate VBLK, part %d.\", rec);\n \t\tf->map &= 0x7F;\t\t\t/* Mark the group as broken */"
        }
    ],
    "parent_commit_sha": "e6c9366b2adb52cba64b359b3050200743c7568c"
}