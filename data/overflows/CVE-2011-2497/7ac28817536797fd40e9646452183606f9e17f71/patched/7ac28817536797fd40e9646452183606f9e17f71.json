{
    "owner": "torvalds",
    "repo": "linux",
    "commit_sha": "7ac28817536797fd40e9646452183606f9e17f71",
    "commit_massage": "Bluetooth: Prevent buffer overflow in l2cap config request\n\nA remote user can provide a small value for the command size field in\nthe command header of an l2cap configuration request, resulting in an\ninteger underflow when subtracting the size of the configuration request\nheader.  This results in copying a very large amount of data via\nmemcpy() and destroying the kernel heap.  Check for underflow.\n\nSigned-off-by: Dan Rosenberg <drosenberg@vsecurity.com>\nCc: stable <stable@kernel.org>\nSigned-off-by: Gustavo F. Padovan <padovan@profusion.mobi>",
    "raw_ref": "https://api.github.com/repos/torvalds/linux/commits/7ac28817536797fd40e9646452183606f9e17f71",
    "html_ref": "https://github.com/torvalds/linux/commit/7ac28817536797fd40e9646452183606f9e17f71",
    "author": "Dan Rosenberg",
    "changes_stats": {
        "total": 2,
        "additions": 1,
        "deletions": 1
    },
    "files": [
        {
            "sha": "7d8a66b04f50c5d63a6a8a9b2ba0e9e74dd591ec",
            "filename": "net/bluetooth/l2cap_core.c",
            "status": "modified",
            "additions": 1,
            "deletions": 1,
            "changes": 2,
            "blob_url": "https://github.com/torvalds/linux/blob/7ac28817536797fd40e9646452183606f9e17f71/net%2Fbluetooth%2Fl2cap_core.c",
            "raw_url": "https://github.com/torvalds/linux/raw/7ac28817536797fd40e9646452183606f9e17f71/net%2Fbluetooth%2Fl2cap_core.c",
            "contents_url": "https://api.github.com/repos/torvalds/linux/contents/net%2Fbluetooth%2Fl2cap_core.c?ref=7ac28817536797fd40e9646452183606f9e17f71",
            "patch": "@@ -2334,7 +2334,7 @@ static inline int l2cap_config_req(struct l2cap_conn *conn, struct l2cap_cmd_hdr\n \n \t/* Reject if config buffer is too small. */\n \tlen = cmd_len - sizeof(*req);\n-\tif (chan->conf_len + len > sizeof(chan->conf_req)) {\n+\tif (len < 0 || chan->conf_len + len > sizeof(chan->conf_req)) {\n \t\tl2cap_send_cmd(conn, cmd->ident, L2CAP_CONF_RSP,\n \t\t\t\tl2cap_build_conf_rsp(chan, rsp,\n \t\t\t\t\tL2CAP_CONF_REJECT, flags), rsp);"
        }
    ],
    "parent_commit_sha": "fa7ccfb17033bfb5bca86f6b909cab0b807efbc0"
}