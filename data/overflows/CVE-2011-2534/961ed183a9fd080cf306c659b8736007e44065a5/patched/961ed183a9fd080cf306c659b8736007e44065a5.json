{
    "owner": "torvalds",
    "repo": "linux",
    "commit_sha": "961ed183a9fd080cf306c659b8736007e44065a5",
    "commit_massage": "netfilter: ipt_CLUSTERIP: fix buffer overflow\n\n'buffer' string is copied from userspace.  It is not checked whether it is\nzero terminated.  This may lead to overflow inside of simple_strtoul().\nChangli Gao suggested to copy not more than user supplied 'size' bytes.\n\nIt was introduced before the git epoch.  Files \"ipt_CLUSTERIP/*\" are\nroot writable only by default, however, on some setups permissions might be\nrelaxed to e.g. network admin user.\n\nSigned-off-by: Vasiliy Kulikov <segoon@openwall.com>\nAcked-by: Changli Gao <xiaosuo@gmail.com>\nSigned-off-by: Patrick McHardy <kaber@trash.net>",
    "raw_ref": "https://api.github.com/repos/torvalds/linux/commits/961ed183a9fd080cf306c659b8736007e44065a5",
    "html_ref": "https://github.com/torvalds/linux/commit/961ed183a9fd080cf306c659b8736007e44065a5",
    "author": "segoon",
    "changes_stats": {
        "total": 5,
        "additions": 4,
        "deletions": 1
    },
    "files": [
        {
            "sha": "d609ac3cb9a450e69d47e4d5bdb7365347cbb46a",
            "filename": "net/ipv4/netfilter/ipt_CLUSTERIP.c",
            "status": "modified",
            "additions": 4,
            "deletions": 1,
            "changes": 5,
            "blob_url": "https://github.com/torvalds/linux/blob/961ed183a9fd080cf306c659b8736007e44065a5/net%2Fipv4%2Fnetfilter%2Fipt_CLUSTERIP.c",
            "raw_url": "https://github.com/torvalds/linux/raw/961ed183a9fd080cf306c659b8736007e44065a5/net%2Fipv4%2Fnetfilter%2Fipt_CLUSTERIP.c",
            "contents_url": "https://api.github.com/repos/torvalds/linux/contents/net%2Fipv4%2Fnetfilter%2Fipt_CLUSTERIP.c?ref=961ed183a9fd080cf306c659b8736007e44065a5",
            "patch": "@@ -664,8 +664,11 @@ static ssize_t clusterip_proc_write(struct file *file, const char __user *input,\n \tchar buffer[PROC_WRITELEN+1];\n \tunsigned long nodenum;\n \n-\tif (copy_from_user(buffer, input, PROC_WRITELEN))\n+\tif (size > PROC_WRITELEN)\n+\t\treturn -EIO;\n+\tif (copy_from_user(buffer, input, size))\n \t\treturn -EFAULT;\n+\tbuffer[size] = 0;\n \n \tif (*buffer == '+') {\n \t\tnodenum = simple_strtoul(buffer+1, NULL, 10);"
        }
    ],
    "parent_commit_sha": "db856674ac69e31946e56085239757cca3f7655f"
}