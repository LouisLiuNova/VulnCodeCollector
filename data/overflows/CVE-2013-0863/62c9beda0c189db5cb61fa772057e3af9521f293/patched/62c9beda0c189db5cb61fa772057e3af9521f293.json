{
    "owner": "FFmpeg",
    "repo": "FFmpeg",
    "commit_sha": "62c9beda0c189db5cb61fa772057e3af9521f293",
    "commit_massage": "sanm: Check decoded_size.\n\nThis prevents a buffer overflow in rle_decode()\n\nFound-by: Mateusz \"j00ru\" Jurczyk and Gynvael Coldwind\nSigned-off-by: Michael Niedermayer <michaelni@gmx.at>\n(cherry picked from commit 7357ca900efcf829de4cce4cec6ddc286526d417)\n\nSigned-off-by: Michael Niedermayer <michaelni@gmx.at>",
    "raw_ref": "https://api.github.com/repos/FFmpeg/FFmpeg/commits/62c9beda0c189db5cb61fa772057e3af9521f293",
    "html_ref": "https://github.com/FFmpeg/FFmpeg/commit/62c9beda0c189db5cb61fa772057e3af9521f293",
    "author": "michaelni",
    "changes_stats": {
        "total": 5,
        "additions": 5,
        "deletions": 0
    },
    "files": [
        {
            "sha": "0f68e1d1ed9d0b9ca14d054f42372069ea05fc45",
            "filename": "libavcodec/sanm.c",
            "status": "modified",
            "additions": 5,
            "deletions": 0,
            "changes": 5,
            "blob_url": "https://github.com/FFmpeg/FFmpeg/blob/62c9beda0c189db5cb61fa772057e3af9521f293/libavcodec%2Fsanm.c",
            "raw_url": "https://github.com/FFmpeg/FFmpeg/raw/62c9beda0c189db5cb61fa772057e3af9521f293/libavcodec%2Fsanm.c",
            "contents_url": "https://api.github.com/repos/FFmpeg/FFmpeg/contents/libavcodec%2Fsanm.c?ref=62c9beda0c189db5cb61fa772057e3af9521f293",
            "patch": "@@ -639,6 +639,11 @@ static int old_codec47(SANMVideoContext *ctx, int top,\n     decoded_size = bytestream2_get_le32(&ctx->gb);\n     bytestream2_skip(&ctx->gb, 8);\n \n+    if (decoded_size > height * stride - left - top * stride) {\n+        decoded_size = height * stride - left - top * stride;\n+        av_log(ctx->avctx, AV_LOG_WARNING, \"decoded size is too large\\n\");\n+    }\n+\n     if (skip & 1)\n         bytestream2_skip(&ctx->gb, 0x8080);\n     if (!seq) {"
        }
    ],
    "parent_commit_sha": "0e68b6ddce2945dd367b3d8566dde061b51332af"
}