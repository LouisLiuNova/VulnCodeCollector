{
    "owner": "torvalds",
    "repo": "linux",
    "commit_sha": "201f99f170df14ba52ea4c52847779042b7a623b",
    "commit_massage": "uml: check length in exitcode_proc_write()\n\nWe don't cap the size of buffer from the user so we could write past the\nend of the array here.  Only root can write to this file.\n\nReported-by: Nico Golde <nico@ngolde.de>\nReported-by: Fabian Yamaguchi <fabs@goesec.de>\nSigned-off-by: Dan Carpenter <dan.carpenter@oracle.com>\nCc: stable@kernel.org\nSigned-off-by: Linus Torvalds <torvalds@linux-foundation.org>",
    "raw_ref": "https://api.github.com/repos/torvalds/linux/commits/201f99f170df14ba52ea4c52847779042b7a623b",
    "html_ref": "https://github.com/torvalds/linux/commit/201f99f170df14ba52ea4c52847779042b7a623b",
    "author": "Dan Carpenter",
    "changes_stats": {
        "total": 4,
        "additions": 3,
        "deletions": 1
    },
    "files": [
        {
            "sha": "41ebbfebb3332f2bc7269a754ff96b377e17212b",
            "filename": "arch/um/kernel/exitcode.c",
            "status": "modified",
            "additions": 3,
            "deletions": 1,
            "changes": 4,
            "blob_url": "https://github.com/torvalds/linux/blob/201f99f170df14ba52ea4c52847779042b7a623b/arch%2Fum%2Fkernel%2Fexitcode.c",
            "raw_url": "https://github.com/torvalds/linux/raw/201f99f170df14ba52ea4c52847779042b7a623b/arch%2Fum%2Fkernel%2Fexitcode.c",
            "contents_url": "https://api.github.com/repos/torvalds/linux/contents/arch%2Fum%2Fkernel%2Fexitcode.c?ref=201f99f170df14ba52ea4c52847779042b7a623b",
            "patch": "@@ -40,9 +40,11 @@ static ssize_t exitcode_proc_write(struct file *file,\n \t\tconst char __user *buffer, size_t count, loff_t *pos)\n {\n \tchar *end, buf[sizeof(\"nnnnn\\0\")];\n+\tsize_t size;\n \tint tmp;\n \n-\tif (copy_from_user(buf, buffer, count))\n+\tsize = min(count, sizeof(buf));\n+\tif (copy_from_user(buf, buffer, size))\n \t\treturn -EFAULT;\n \n \ttmp = simple_strtol(buf, &end, 0);"
        }
    ],
    "parent_commit_sha": "7314e613d5ff9f0934f7a0f74ed7973b903315d1"
}