{
    "owner": "torvalds",
    "repo": "linux",
    "commit_sha": "7d3e91a89b7adbc2831334def9e494dd9892f9af",
    "commit_massage": "NFSv4: Check for buffer length in __nfs4_get_acl_uncached\n\nCommit 1f1ea6c \"NFSv4: Fix buffer overflow checking in\n__nfs4_get_acl_uncached\" accidently dropped the checking for too small\nresult buffer length.\n\nIf someone uses getxattr on \"system.nfs4_acl\" on an NFSv4 mount\nsupporting ACLs, the ACL has not been cached and the buffer suplied is\ntoo short, we still copy the complete ACL, resulting in kernel and user\nspace memory corruption.\n\nSigned-off-by: Sven Wegener <sven.wegener@stealer.net>\nCc: stable@kernel.org\nSigned-off-by: Trond Myklebust <Trond.Myklebust@netapp.com>",
    "raw_ref": "https://api.github.com/repos/torvalds/linux/commits/7d3e91a89b7adbc2831334def9e494dd9892f9af",
    "html_ref": "https://github.com/torvalds/linux/commit/7d3e91a89b7adbc2831334def9e494dd9892f9af",
    "author": "swegener",
    "changes_stats": {
        "total": 7,
        "additions": 6,
        "deletions": 1
    },
    "files": [
        {
            "sha": "05e5f6f9f2b80b22fa306d33fcdd06c6540725f3",
            "filename": "fs/nfs/nfs4proc.c",
            "status": "modified",
            "additions": 6,
            "deletions": 1,
            "changes": 7,
            "blob_url": "https://github.com/torvalds/linux/blob/7d3e91a89b7adbc2831334def9e494dd9892f9af/fs%2Fnfs%2Fnfs4proc.c",
            "raw_url": "https://github.com/torvalds/linux/raw/7d3e91a89b7adbc2831334def9e494dd9892f9af/fs%2Fnfs%2Fnfs4proc.c",
            "contents_url": "https://api.github.com/repos/torvalds/linux/contents/fs%2Fnfs%2Fnfs4proc.c?ref=7d3e91a89b7adbc2831334def9e494dd9892f9af",
            "patch": "@@ -3937,8 +3937,13 @@ static ssize_t __nfs4_get_acl_uncached(struct inode *inode, void *buf, size_t bu\n \t\tgoto out_free;\n \t}\n \tnfs4_write_cached_acl(inode, pages, res.acl_data_offset, res.acl_len);\n-\tif (buf)\n+\tif (buf) {\n+\t\tif (res.acl_len > buflen) {\n+\t\t\tret = -ERANGE;\n+\t\t\tgoto out_free;\n+\t\t}\n \t\t_copy_from_pages(buf, pages, res.acl_data_offset, res.acl_len);\n+\t}\n out_ok:\n \tret = res.acl_len;\n out_free:"
        }
    ],
    "parent_commit_sha": "4c1002100898d03c5c9142ffaf58351c841ab94a"
}