{
    "owner": "qemu",
    "repo": "qemu",
    "commit_sha": "a6b3167fa0e825aebb5a7cd8b437b6d41584a196",
    "commit_massage": "block/iscsi: avoid potential overflow of acb->task->cdb\n\nat least in the path via virtio-blk the maximum size is not\nrestricted.\n\nCc: qemu-stable@nongnu.org\nSigned-off-by: Peter Lieven <pl@kamp.de>\nMessage-Id: <1464080368-29584-1-git-send-email-pl@kamp.de>\nSigned-off-by: Paolo Bonzini <pbonzini@redhat.com>",
    "raw_ref": "https://api.github.com/repos/qemu/qemu/commits/a6b3167fa0e825aebb5a7cd8b437b6d41584a196",
    "html_ref": "https://github.com/qemu/qemu/commit/a6b3167fa0e825aebb5a7cd8b437b6d41584a196",
    "author": "plieven",
    "changes_stats": {
        "total": 7,
        "additions": 7,
        "deletions": 0
    },
    "files": [
        {
            "sha": "e7d5f7b0c3e8c781e858289b7b0b4161791c77ee",
            "filename": "block/iscsi.c",
            "status": "modified",
            "additions": 7,
            "deletions": 0,
            "changes": 7,
            "blob_url": "https://github.com/qemu/qemu/blob/a6b3167fa0e825aebb5a7cd8b437b6d41584a196/block%2Fiscsi.c",
            "raw_url": "https://github.com/qemu/qemu/raw/a6b3167fa0e825aebb5a7cd8b437b6d41584a196/block%2Fiscsi.c",
            "contents_url": "https://api.github.com/repos/qemu/qemu/contents/block%2Fiscsi.c?ref=a6b3167fa0e825aebb5a7cd8b437b6d41584a196",
            "patch": "@@ -833,6 +833,13 @@ static BlockAIOCB *iscsi_aio_ioctl(BlockDriverState *bs,\n         return &acb->common;\n     }\n \n+    if (acb->ioh->cmd_len > SCSI_CDB_MAX_SIZE) {\n+        error_report(\"iSCSI: ioctl error CDB exceeds max size (%d > %d)\",\n+                     acb->ioh->cmd_len, SCSI_CDB_MAX_SIZE);\n+        qemu_aio_unref(acb);\n+        return NULL;\n+    }\n+\n     acb->task = malloc(sizeof(struct scsi_task));\n     if (acb->task == NULL) {\n         error_report(\"iSCSI: Failed to allocate task for scsi command. %s\","
        }
    ],
    "parent_commit_sha": "b60bdd1f1ee1616b7a9aeeffb4088e1ce2710fb2"
}