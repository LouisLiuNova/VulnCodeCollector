{
    "owner": "qemu",
    "repo": "qemu",
    "commit_sha": "a08aaff811fb194950f79711d2afe5a892ae03a4",
    "commit_massage": "virtio-crypto: fix possible integer and heap overflow\n\nBecause the 'size_t' type is 4 bytes in 32-bit platform, which\nis the same with 'int'. It's easy to make 'max_len' to zero when\ninteger overflow and then cause heap overflow if 'max_len' is zero.\n\nUsing uint_64 instead of size_t to avoid the integer overflow.\n\nCc: qemu-stable@nongnu.org\nReported-by: Li Qiang <liqiang6-s@360.cn>\nSigned-off-by: Gonglei <arei.gonglei@huawei.com>\nTested-by: Li Qiang <liqiang6-s@360.cn>\nReviewed-by: Michael S. Tsirkin <mst@redhat.com>\nSigned-off-by: Michael S. Tsirkin <mst@redhat.com>",
    "raw_ref": "https://api.github.com/repos/qemu/qemu/commits/a08aaff811fb194950f79711d2afe5a892ae03a4",
    "html_ref": "https://github.com/qemu/qemu/commit/a08aaff811fb194950f79711d2afe5a892ae03a4",
    "author": "gongleiarei",
    "changes_stats": {
        "total": 4,
        "additions": 2,
        "deletions": 2
    },
    "files": [
        {
            "sha": "c23e1ad4588a4d17c9f1e4553d1186c053fe5e29",
            "filename": "hw/virtio/virtio-crypto.c",
            "status": "modified",
            "additions": 2,
            "deletions": 2,
            "changes": 4,
            "blob_url": "https://github.com/qemu/qemu/blob/a08aaff811fb194950f79711d2afe5a892ae03a4/hw%2Fvirtio%2Fvirtio-crypto.c",
            "raw_url": "https://github.com/qemu/qemu/raw/a08aaff811fb194950f79711d2afe5a892ae03a4/hw%2Fvirtio%2Fvirtio-crypto.c",
            "contents_url": "https://api.github.com/repos/qemu/qemu/contents/hw%2Fvirtio%2Fvirtio-crypto.c?ref=a08aaff811fb194950f79711d2afe5a892ae03a4",
            "patch": "@@ -416,7 +416,7 @@ virtio_crypto_sym_op_helper(VirtIODevice *vdev,\n     uint32_t hash_start_src_offset = 0, len_to_hash = 0;\n     uint32_t cipher_start_src_offset = 0, len_to_cipher = 0;\n \n-    size_t max_len, curr_size = 0;\n+    uint64_t max_len, curr_size = 0;\n     size_t s;\n \n     /* Plain cipher */\n@@ -441,7 +441,7 @@ virtio_crypto_sym_op_helper(VirtIODevice *vdev,\n         return NULL;\n     }\n \n-    max_len = iv_len + aad_len + src_len + dst_len + hash_result_len;\n+    max_len = (uint64_t)iv_len + aad_len + src_len + dst_len + hash_result_len;\n     if (unlikely(max_len > vcrypto->conf.max_size)) {\n         virtio_error(vdev, \"virtio-crypto too big length\");\n         return NULL;"
        }
    ],
    "parent_commit_sha": "8cdcf3c1e58d04b6811956d7608efeb66c42d719"
}