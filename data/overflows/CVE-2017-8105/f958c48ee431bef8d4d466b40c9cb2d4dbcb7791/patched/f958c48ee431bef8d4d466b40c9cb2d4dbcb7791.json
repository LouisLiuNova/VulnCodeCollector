{
    "owner": "freetype",
    "repo": "freetype",
    "commit_sha": "f958c48ee431bef8d4d466b40c9cb2d4dbcb7791",
    "commit_massage": "[psaux] Better protect `flex' handling.\n\nReported as\n\n  https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=935\n\n* src/psaux/t1decode.c (t1_decoder_parse_charstrings)\n<callothersubr>: Since there is not a single flex operator but a\nseries of subroutine calls, malformed fonts can call arbitrary other\noperators after the start of a flex, possibly adding points.  For\nthis reason we have to check the available number of points before\ninserting a point.",
    "raw_ref": "https://api.github.com/repos/freetype/freetype/commits/f958c48ee431bef8d4d466b40c9cb2d4dbcb7791",
    "html_ref": "https://github.com/freetype/freetype/commit/f958c48ee431bef8d4d466b40c9cb2d4dbcb7791",
    "author": "lemzwerg",
    "changes_stats": {
        "total": 24,
        "additions": 24,
        "deletions": 0
    },
    "files": [
        {
            "sha": "01e9a7be1d200cc6e35e7bd06c5aa7572ce112c7",
            "filename": "ChangeLog",
            "status": "modified",
            "additions": 15,
            "deletions": 0,
            "changes": 15,
            "blob_url": "https://github.com/freetype/freetype/blob/f958c48ee431bef8d4d466b40c9cb2d4dbcb7791/ChangeLog",
            "raw_url": "https://github.com/freetype/freetype/raw/f958c48ee431bef8d4d466b40c9cb2d4dbcb7791/ChangeLog",
            "contents_url": "https://api.github.com/repos/freetype/freetype/contents/ChangeLog?ref=f958c48ee431bef8d4d466b40c9cb2d4dbcb7791",
            "patch": "@@ -1,3 +1,18 @@\n+2017-03-23  Werner Lemberg  <wl@gnu.org>\n+\n+\t[psaux] Better protect `flex' handling.\n+\n+\tReported as\n+\n+\t  https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=935\n+\n+\t* src/psaux/t1decode.c (t1_decoder_parse_charstrings)\n+\t<callothersubr>: Since there is not a single flex operator but a\n+\tseries of subroutine calls, malformed fonts can call arbitrary other\n+\toperators after the start of a flex, possibly adding points.  For\n+\tthis reason we have to check the available number of points before\n+\tinserting a point.\n+\n 2017-03-23  Werner Lemberg  <wl@gnu.org>\n \n \t[sfnt] Fix check for default named instance."
        },
        {
            "sha": "7dd45135de3a788986b66bd43c4954202fbfdb57",
            "filename": "src/psaux/t1decode.c",
            "status": "modified",
            "additions": 9,
            "deletions": 0,
            "changes": 9,
            "blob_url": "https://github.com/freetype/freetype/blob/f958c48ee431bef8d4d466b40c9cb2d4dbcb7791/src%2Fpsaux%2Ft1decode.c",
            "raw_url": "https://github.com/freetype/freetype/raw/f958c48ee431bef8d4d466b40c9cb2d4dbcb7791/src%2Fpsaux%2Ft1decode.c",
            "contents_url": "https://api.github.com/repos/freetype/freetype/contents/src%2Fpsaux%2Ft1decode.c?ref=f958c48ee431bef8d4d466b40c9cb2d4dbcb7791",
            "patch": "@@ -780,10 +780,19 @@\n             /* point without adding any point to the outline    */\n             idx = decoder->num_flex_vectors++;\n             if ( idx > 0 && idx < 7 )\n+            {\n+              /* in malformed fonts it is possible to have other */\n+              /* opcodes in the middle of a flex (which don't    */\n+              /* increase `num_flex_vectors'); we thus have to   */\n+              /* check whether we can add a point                */\n+              if ( FT_SET_ERROR( t1_builder_check_points( builder, 1 ) ) )\n+                goto Syntax_Error;\n+\n               t1_builder_add_point( builder,\n                                     x,\n                                     y,\n                                     (FT_Byte)( idx == 3 || idx == 6 ) );\n+            }\n           }\n           break;\n "
        }
    ],
    "parent_commit_sha": "913f436d12dfe682c349eff8bf4cdd9065ff117d"
}