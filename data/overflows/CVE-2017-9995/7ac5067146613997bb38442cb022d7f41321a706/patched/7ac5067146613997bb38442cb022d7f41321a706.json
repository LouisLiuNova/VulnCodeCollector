{
    "owner": "FFmpeg",
    "repo": "FFmpeg",
    "commit_sha": "7ac5067146613997bb38442cb022d7f41321a706",
    "commit_massage": "avcodec/scpr: Check y in first line loop in decompress_i()\n\nFixes: out of array access\nFixes: 1478/clusterfuzz-testcase-minimized-5285486908145664\n\nFound-by: continuous fuzzing process https://github.com/google/oss-fuzz/tree/master/targets/ffmpeg\nSigned-off-by: Michael Niedermayer <michael@niedermayer.cc>",
    "raw_ref": "https://api.github.com/repos/FFmpeg/FFmpeg/commits/7ac5067146613997bb38442cb022d7f41321a706",
    "html_ref": "https://github.com/FFmpeg/FFmpeg/commit/7ac5067146613997bb38442cb022d7f41321a706",
    "author": "michaelni",
    "changes_stats": {
        "total": 3,
        "additions": 3,
        "deletions": 0
    },
    "files": [
        {
            "sha": "b87c047ab659126e8e4a52c3c614fa1cb5cb43fb",
            "filename": "libavcodec/scpr.c",
            "status": "modified",
            "additions": 3,
            "deletions": 0,
            "changes": 3,
            "blob_url": "https://github.com/FFmpeg/FFmpeg/blob/7ac5067146613997bb38442cb022d7f41321a706/libavcodec%2Fscpr.c",
            "raw_url": "https://github.com/FFmpeg/FFmpeg/raw/7ac5067146613997bb38442cb022d7f41321a706/libavcodec%2Fscpr.c",
            "contents_url": "https://api.github.com/repos/FFmpeg/FFmpeg/contents/libavcodec%2Fscpr.c?ref=7ac5067146613997bb38442cb022d7f41321a706",
            "patch": "@@ -331,6 +331,9 @@ static int decompress_i(AVCodecContext *avctx, uint32_t *dst, int linesize)\n         clr = (b << 16) + (g << 8) + r;\n         k += run;\n         while (run-- > 0) {\n+            if (y >= avctx->height)\n+                return AVERROR_INVALIDDATA;\n+\n             dst[y * linesize + x] = clr;\n             lx = x;\n             ly = y;"
        }
    ],
    "parent_commit_sha": "8a69f2602fea04b7ebae2db16f2581e8ff5ee0cd"
}